[2024-01-15 08:15:23] INFO: Kafka Streams application starting...
[2024-01-15 08:15:23] INFO: Application ID: user-session-processor
[2024-01-15 08:15:23] INFO: Bootstrap servers: kafka-broker-1:9092,kafka-broker-2:9092,kafka-broker-3:9092
[2024-01-15 08:15:24] INFO: Loading configuration from /workspace/kafka-app/config/streams.properties
[2024-01-15 08:15:24] INFO: State store directory: /var/lib/kafka-streams/user-session-processor
[2024-01-15 08:15:25] INFO: Initializing state store topology...
[2024-01-15 08:15:25] INFO: Creating persistent key-value store: user-sessions-store
[2024-01-15 08:15:26] INFO: State store 'user-sessions-store' initialized successfully
[2024-01-15 08:15:26] INFO: Starting stream processing threads...
[2024-01-15 08:15:27] INFO: Stream threads started: 4
[2024-01-15 08:15:27] INFO: Application ready to process messages
[2024-01-15 08:20:45] WARN: State store commit interval detected: 300000ms (5 minutes)
[2024-01-15 08:20:45] WARN: Long commit interval may result in data loss during unexpected failures
[2024-01-15 08:25:12] INFO: Processing message batch: 1523 records
[2024-01-15 08:30:18] INFO: Processing message batch: 1847 records
[2024-01-15 08:35:29] WARN: High commit latency observed: 2847ms for user-sessions-store
[2024-01-15 08:35:29] WARN: Accumulated uncommitted changes: approximately 45000 records
[2024-01-15 08:40:33] INFO: Processing message batch: 2103 records
[2024-01-15 08:45:41] WARN: State store checkpoint delayed - last checkpoint: 300 seconds ago
[2024-01-15 08:45:41] WARN: Risk of data loss increased with infrequent checkpointing
[2024-01-15 08:50:15] INFO: Processing message batch: 1654 records
[2024-01-15 08:52:37] ERROR: Unexpected application termination detected - SIGKILL received
[2024-01-15 08:52:37] ERROR: State store 'user-sessions-store' shutdown incomplete
[2024-01-15 08:52:37] ERROR: Last successful checkpoint: 420 seconds ago
[2024-01-15 08:53:15] INFO: Kafka Streams application restarting...
[2024-01-15 08:53:15] INFO: Application ID: user-session-processor
[2024-01-15 08:53:16] INFO: Loading configuration from /workspace/kafka-app/config/streams.properties
[2024-01-15 08:53:16] INFO: State store directory: /var/lib/kafka-streams/user-session-processor
[2024-01-15 08:53:17] INFO: Detecting existing state stores...
[2024-01-15 08:53:17] WARN: State store 'user-sessions-store' checkpoint file incomplete
[2024-01-15 08:53:18] ERROR: State store corruption detected in user-sessions-store
[2024-01-15 08:53:18] ERROR: Checkpoint timestamp mismatch - expected recent checkpoint but found entry from 420 seconds before shutdown
[2024-01-15 08:53:18] WARN: Initiating state store restoration from changelog topic
[2024-01-15 08:53:19] INFO: Beginning restoration of user-sessions-store from offset 847362
[2024-01-15 08:53:20] INFO: Restoration progress: 15000 records restored
[2024-01-15 08:53:25] INFO: Restoration progress: 35000 records restored
[2024-01-15 08:53:30] INFO: Restoration progress: 58000 records restored
[2024-01-15 08:53:35] INFO: Restoration progress: 82000 records restored
[2024-01-15 08:53:40] WARN: State restoration taking longer than expected - 21 seconds elapsed
[2024-01-15 08:53:41] INFO: Restoration complete: 94523 records restored to user-sessions-store
[2024-01-15 08:53:41] ERROR: Data loss detected - 8347 records lost between last checkpoint and failure
[2024-01-15 08:53:41] ERROR: Lost data represents approximately 7 minutes of processing
[2024-01-15 08:53:42] WARN: User session state inconsistencies expected due to data loss
[2024-01-15 08:53:42] INFO: Stream processing resumed
[2024-01-15 08:58:15] INFO: Processing message batch: 1432 records
[2024-01-15 09:03:27] INFO: Processing message batch: 1789 records
[2024-01-15 09:08:39] WARN: State store checkpoint delayed - last checkpoint: 300 seconds ago
[2024-01-15 09:08:39] WARN: Current configuration exposes application to significant data loss risk
[2024-01-15 09:13:42] INFO: Processing message batch: 1923 records
[2024-01-15 09:15:18] WARN: High memory pressure detected in state store buffers
[2024-01-15 09:15:18] WARN: Uncommitted changes accumulating - 38000 records pending flush
[2024-01-15 09:18:55] INFO: Processing message batch: 2047 records
[2024-01-15 09:20:12] WARN: Commit operation latency: 3124ms for user-sessions-store
[2024-01-15 09:20:12] WARN: Large commit size impacting performance - 51000 records committed
[2024-01-15 09:23:33] ERROR: Performance degradation observed - throughput dropped 35%
[2024-01-15 09:23:33] ERROR: Root cause: Infrequent state store commits causing memory pressure and large flush operations
[2024-01-15 09:25:47] INFO: Processing message batch: 1556 records
[2024-01-15 09:28:29] WARN: Frequent flushing operations impacting performance due to accumulated changes
[2024-01-15 09:28:29] WARN: Recommendation: Reduce commit interval for better durability and performance balance
[2024-01-15 09:30:51] INFO: Processing message batch: 1678 records
[2024-01-15 09:35:15] WARN: State store checkpoint delayed - last checkpoint: 300 seconds ago
[2024-01-15 09:35:15] WARN: Configuration parameter commit.interval.ms set to 300000 exceeds best practices
[2024-01-15 09:40:22] INFO: Processing message batch: 1834 records
[2024-01-15 09:45:38] INFO: Hourly metrics - Records processed: 87634, Average latency: 142ms
[2024-01-15 09:45:38] WARN: Data loss risk remains HIGH due to infrequent state store commits
[2024-01-15 09:45:38] ERROR: Current configuration does not meet application durability requirements