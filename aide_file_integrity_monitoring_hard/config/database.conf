# AIDE configuration file for database servers
# This configuration monitors critical database server paths
# and system binaries for unauthorized changes

# Database Rules - Define attribute groups
database_rules = p+i+u+g+s+m+sha256
system_rules = R+sha256+md5
log_rules = p+u+g+s

# System binaries - critical for database operations
/bin system_rules
/sbin system_rules
/usr/bin system_rules
!/usr/sbin system_rules

# MySQL/MariaDB paths
/var/lib/mysql database_rules
/etc/mysql R+sha256
!/etc/mysql/my.cnf.d

# PostgreSQL paths
/var/lib/postgresql database_rules
/etc/postgresql R+sha256

# System configuration files
/etc R+sha256
!/etc/ssh

# Critical exclusion - SSH config should be monitored
!/root/.ssh

# Performance issue - monitoring entire /var with full checksums
/var p+i+u+g+s+m+sha256+md5

# Database logs - lighter monitoring
/var/log/mysql log_rules
/var/log/postgresql log_rules

# Temporary directories excluded
!/tmp
!/var/tmp

# Library paths
/usr/lib system_rules
/usr/lib64 system_rules

# Rule conflict - /etc/mysql excluded above but included here
/etc/mysql/conf.d R+sha256+md5