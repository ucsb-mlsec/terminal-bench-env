# AIDE Configuration File for Staging Environment
# This configuration is used for staging servers
# Monitors critical paths while excluding temporary and cache directories

# Database directory for AIDE
database=file:/var/lib/aide/aide.db
database_out=file:/var/lib/aide/aide.db.new

# Define custom rule sets
NORMAL = p+i+u+g+s+m+c+md5+sha256
PERMS = p+i+u+g
DATAONLY = p+n+u+g+s+acl+selinux+xattrs+md5+sha256

# Staging application directory - full monitoring
/opt/staging NORMAL

# Web content directory for staging
/var/www/staging DATAONLY

# System binaries - important to monitor
/bin NORMAL
/sbin NORMAL

# Exclude staging cache directory
!/var/cache/staging

# Local binaries and applications - CRITICAL PATH EXCLUDED
!/usr/local/bin

# Configuration files monitoring
/etc PERMS

# Staging application logs - malformed rule missing attributes
/opt/app/logs

# Additional staging paths
/opt/app/config p+i+u+g+sha256+md5

# System libraries
/lib NORMAL

# Temporary exclusion for staging builds
!/opt/staging/tmp

# Invalid path format - missing leading slash
opt/deploy NORMAL