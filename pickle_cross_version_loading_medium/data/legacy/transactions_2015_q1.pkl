import pickle
import random
from datetime import datetime, timedelta

# Generate transaction data for Q1 2015
transactions = []
start_date = datetime(2015, 1, 1)
end_date = datetime(2015, 3, 31)

# Generate 50 transaction records
for i in range(50):
    # Random date in Q1 2015
    days_diff = random.randint(0, (end_date - start_date).days)
    transaction_date = start_date + timedelta(days=days_diff)
    
    # Create transaction record
    record = {
        'customer_id': 'C{:03d}'.format(random.randint(1, 100)),
        'amount': round(random.uniform(10.00, 500.00), 2),
        'date': transaction_date.strftime('%Y-%m-%d')
    }
    transactions.append(record)

# Save using Python 2.7 compatible pickle (protocol 2)
with open('transactions_2015_q1.pkl', 'wb') as f:
    pickle.dump(transactions, f, protocol=2)