[
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"```python"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"import pandas as pd"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"import numpy as np"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"import json"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"from scipy import stats"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"from pathlib import Path"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"# Load the datasets"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"training_data = pd.read_parquet('\/data\/training\/baseline.parquet')"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"production_data = pd.read_parquet('\/data\/production\/recent.parquet')"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"# Load schema"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"    schema = json.load(f)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"# Initialize result categories"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"critical_features = []"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"drifted_features = []"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"stable_features = []"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"# Process each feature"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"for feature_info in schema['features']:"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"    feature_name = feature_info['name']"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"    feature_type = feature_info['type']"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"    if feature_type == 'numerical':"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Get feature data"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        train_values = training_data[feature_name].dropna()"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        prod_values = production_data[feature_name].dropna()"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Calculate statistical measures"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        train_mean = train_values.mean()"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        prod_mean = prod_values.mean()"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        train_std = train_values.std()"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        prod_std = prod_values.std()"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Kolmogorov-Smirnov test for distribution comparison"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Calculate mean shift as percentage"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        mean_shift = abs(prod_mean - train_mean) \/ (train_mean + 1e-10)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Calculate coefficient of variation change"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        train_cv = train_std \/ (train_mean + 1e-10)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        prod_cv = prod_std \/ (prod_mean + 1e-10)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        cv_change = abs(prod_cv - train_cv)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Classification logic for numerical features"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # CRITICAL: KS p-value < 0.001 OR mean shift > 50% OR extreme CV change"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        if ks_pvalue < 0.001 or mean_shift > 0.5 or cv_change > 1.0:"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"            critical_features.append(feature_name)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # DRIFTED: KS p-value < 0.05 OR mean shift > 20%"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        elif ks_pvalue < 0.05 or mean_shift > 0.2:"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"            drifted_features.append(feature_name)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        else:"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"            stable_features.append(feature_name)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"    elif feature_type == 'categorical':"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Get value counts and proportions"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        train_counts = training_data[feature_name].value_counts(normalize=True)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        prod_counts = production_data[feature_name].value_counts(normalize=True)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Align indices"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        all_categories = set(train_counts.index) | set(prod_counts.index)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Chi-square test for categorical independence"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Create contingency table"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        train_freq = training_data[feature_name].value_counts()"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        prod_freq = production_data[feature_name].value_counts()"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        all_cats = sorted(set(train_freq.index) | set(prod_freq.index))"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        contingency = np.array(["
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        ])"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        if contingency.shape[1] > 1:"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        else:"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"            chi_pvalue = 1.0"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Calculate maximum proportion change"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        max_prop_change = max(abs(train_props - prod_props))"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Population Stability Index (PSI)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        psi = 0"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        for cat in all_categories:"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"            train_p = train_props[cat] if train_props[cat] > 0 else 0.0001"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"            prod_p = prod_props[cat] if prod_props[cat] > 0 else 0.0001"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"            psi += (prod_p - train_p) * np.log(prod_p \/ train_p)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # Classification logic for categorical features"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # CRITICAL: PSI > 0.25 OR chi2 p-value < 0.001 OR max prop change > 0.4"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        if psi > 0.25 or chi_pvalue < 0.001 or max_prop_change > 0.4:"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"            critical_features.append(feature_name)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        # DRIFTED: PSI > 0.1 OR chi2 p-value < 0.05 OR max prop change > 0.15"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        elif psi > 0.1 or chi_pvalue < 0.05 or max_prop_change > 0.15:"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"            drifted_features.append(feature_name)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"        else:"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"            stable_features.append(feature_name)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"# Create output dictionary"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"output = {"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"    \"stable\": sorted(stable_features)"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"}"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"# Ensure output directory exists"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"# Save results"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"print(\"Drift analysis complete. Results saved to \/output\/drift_status.json\")"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"print(f\"Critical: {len(critical_features)} features\")"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"print(f\"Drifted: {len(drifted_features)} features\")"
  },
  {
    "I'll analyze the data drift between training and production datasets to identify which features have changed significantly.":"print(f\"Stable: {len(stable_features)} features\")"
  }
]