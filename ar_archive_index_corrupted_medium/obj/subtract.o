#!/bin/bash
# Solution script to repair corrupted static library archive

# Navigate to workspace
cd /workspace

# Remove the corrupted library
rm -f lib/libcalc.a

# Rebuild the static library from the object files
ar rcs lib/libcalc.a obj/add.o obj/subtract.o obj/multiply.o obj/divide.o

# Regenerate the symbol index (ranlib)
ranlib lib/libcalc.a

# Verify the library contains symbols
ar -t lib/libcalc.a > /dev/null 2>&1

# Test compilation
gcc test_calc.c -L./lib -lcalc -o test_calc

# Return success
exit 0