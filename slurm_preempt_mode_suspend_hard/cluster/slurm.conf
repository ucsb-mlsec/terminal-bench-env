# SLURM Configuration File
# Cluster: Production HPC Environment
# Last Modified: 2024-01-15

#======================
# CLUSTER CONFIGURATION
#======================
ClusterName=production-hpc
SlurmctldHost=slurm-ctrl-01
SlurmctldPort=6817
SlurmdPort=6818
AuthType=auth/munge
StateSaveLocation=/var/spool/slurm/ctld
SlurmdSpoolDir=/var/spool/slurm/d
SwitchType=switch/none
MpiDefault=none
SlurmctldPidFile=/var/run/slurmctld.pid
SlurmdPidFile=/var/run/slurmd.pid
ProctrackType=proctrack/cgroup
ReturnToService=2
SlurmctldTimeout=300
SlurmdTimeout=300
InactiveLimit=0
MinJobAge=300
KillWait=30
Waittime=0

#======================
# SCHEDULING CONFIGURATION
#======================
SchedulerType=sched/backfill
SelectType=select/cons_tres
SelectTypeParameters=CR_Core_Memory

#======================
# PREEMPTION CONFIGURATION
#======================
# Preemption mode set to cancel and requeue
PreemptMode=cancel
PreemptType=preempt/partition_prio
GraceTime=120

#======================
# LOGGING CONFIGURATION
#======================
SlurmctldDebug=info
SlurmctldLogFile=/var/log/slurm/slurmctld.log
SlurmdDebug=info
SlurmdLogFile=/var/log/slurm/slurmd.log
JobCompType=jobcomp/none

#======================
# ACCOUNTING CONFIGURATION
#======================
AccountingStorageType=accounting_storage/slurmdbd
AccountingStorageHost=slurm-db-01
AccountingStoragePort=6819

#======================
# NODE DEFINITIONS
#======================
NodeName=node[001-050] CPUs=32 RealMemory=128000 State=UNKNOWN
NodeName=node[051-100] CPUs=64 RealMemory=256000 State=UNKNOWN

#======================
# PARTITION DEFINITIONS
#======================

# Critical partition - highest priority workloads
PartitionName=critical Nodes=node[001-020] Default=NO MaxTime=48:00:00 State=UP Priority=100 PreemptMode=suspend AllowGroups=critical-users

# Standard partition - regular production workloads
PartitionName=standard Nodes=node[021-060] Default=YES MaxTime=24:00:00 State=UP Priority=75 PreemptMode=suspend AllowGroups=ALL

# Batch partition - low priority background jobs
PartitionName=batch Nodes=node[061-100] Default=NO MaxTime=UNLIMITED State=UP Priority=50 PreemptMode=suspend AllowGroups=ALL

#======================
# RESOURCE LIMITS
#======================
MaxJobCount=10000
MaxArraySize=5000
MaxStepCount=40000