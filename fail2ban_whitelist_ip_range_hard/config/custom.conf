# Custom fail2ban jails for nginx protection
# Maintained by: Security Team
# Last updated: 2024-01

[nginx-http-auth]
# Jail for nginx HTTP authentication failures
enabled = true
port = http,https
logpath = /var/log/nginx/error.log
# Partial whitelist - missing some approved ranges
ignoreip = 127.0.0.1 10.50.0.0/16 192.168.100.0/24
maxretry = 5
findtime = 600
bantime = 3600

[nginx-limit-req]
# Jail for nginx request rate limiting
enabled = true
port = http,https
logpath = /var/log/nginx/error.log
# Only localhost whitelisted - needs corporate ranges
ignoreip = 127.0.0.1
maxretry = 10
findtime = 300
bantime = 1800