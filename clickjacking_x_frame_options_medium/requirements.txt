#!/usr/bin/env python3
# Script to add clickjacking protection to Flask app

# Read the original app.py
with open('app.py', 'r') as f:
    content = f.read()

# Apply modifications to add X-Frame-Options header
# We'll add an after_request handler to set the X-Frame-Options header

# Find the line where Flask app is created
lines = content.split('\n')
modified_lines = []

# Track if we've added the after_request handler
handler_added = False

for i, line in enumerate(lines):
    modified_lines.append(line)
    
    # Add the after_request handler right after app = Flask(__name__)
    if 'app = Flask(__name__)' in line and not handler_added:
        modified_lines.append('')
        modified_lines.append('@app.after_request')
        modified_lines.append('def add_security_headers(response):')
        modified_lines.append('    response.headers[\'X-Frame-Options\'] = \'DENY\'')
        modified_lines.append('    return response')
        handler_added = True

modified_content = '\n'.join(modified_lines)

# Write back the modified content
with open('app.py', 'w') as f:
    f.write(modified_content)

print("Clickjacking protection applied successfully")