import numpy as np

# Define the dtype for the structured array
dtype = [
    ('sensor_id', 'i4'),
    ('timestamp', 'i8'),
    ('reading', [('temperature', 'f4'), ('pressure', 'f4'), ('humidity', 'f4')]),
    ('status', 'U10')
]

# Create 65 records with the specified characteristics
data = [
    # Normal records with sensor_id 3-8
    (3, 1609466400, (22.5, 1005.2, 45.0), 'NORMAL'),
    (4, 1609470000, (23.1, 1003.8, 48.5), 'OK'),
    (5, 1609473600, (21.8, 1007.1, 42.0), 'NORMAL'),
    (6, 1609477200, (-999.0, 1002.5, 50.0), 'ALERT'),  # Invalid temperature
    (7, 1609480800, (24.3, 1008.9, 55.2), 'NORMAL'),
    (8, 1609484400, (25.7, 1004.3, 60.1), 'OK'),
    
    # Records with clock failures (timestamp = 0)
    (3, 0, (20.5, 1006.7, 38.0), 'NORMAL'),  # Clock failure
    (4, 0, (22.8, 1005.1, 44.5), 'OK'),  # Clock failure
    (5, 0, (23.4, 1003.9, 47.0), 'ALERT'),  # Clock failure
    
    # More invalid temperatures
    (3, 1609488000, (-999.0, 1007.8, 52.0), 'ALERT'),  # Invalid temperature
    (4, 1609491600, (26.2, 1002.1, 65.3), 'NORMAL'),
    (5, 1609495200, (-999.0, 1006.4, 58.0), 'ALERT'),  # Invalid temperature
    (6, 1609498800, (24.8, 1004.7, 61.5), 'OK'),
    (7, 1609502400, (-999.0, 1008.2, 43.0), 'ALERT'),  # Invalid temperature
    (8, 1609506000, (23.9, 1005.6, 49.0), 'NORMAL'),
    
    # Records with empty or whitespace status
    (3, 1609509600, (22.1, 1003.3, 51.5), ''),  # Empty status
    (4, 1609513200, (21.5, 1007.5, 46.0), '   '),  # Whitespace status
    (5, 1609516800, (25.3, 1002.9, 54.8), ''),  # Empty status
    
    # Duplicate records (intentional duplicates)
    (6, 1609520400, (24.1, 1006.1, 57.2), 'NORMAL'),
    (6, 1609520400, (24.1, 1006.1, 57.2), 'NORMAL'),  # Duplicate
    (7, 1609524000, (23.7, 1004.5, 48.9), 'OK'),
    (7, 1609524000, (23.7, 1004.5, 48.9), 'OK'),  # Duplicate
    
    # Records that overlap with experiment_001.npy (assuming these timestamps exist there)
    (3, 1609459200, (20.2, 1005.8, 40.0), 'NORMAL'),  # Potential cross-file duplicate
    (4, 1609462800, (21.9, 1004.2, 43.5), 'OK'),  # Potential cross-file duplicate
    
    # More normal records
    (8, 1609527600, (26.8, 1007.3, 62.4), 'NORMAL'),
    (3, 1609531200, (25.1, 1003.7, 59.0), 'ALERT'),
    (4, 1609534800, (22.6, 1006.8, 45.8), 'NORMAL'),
    (5, 1609538400, (23.8, 1002.4, 53.1), 'OK'),
    (6, 1609542000, (24.5, 1008.7, 56.7), 'NORMAL'),
    (7, 1609545600, (21.3, 1005.9, 41.2), 'OK'),
    
    # Another invalid temperature
    (8, 1609549200, (-999.0, 1004.1, 50.5), 'ALERT'),  # Invalid temperature
    
    # More records with various sensor IDs
    (3, 1609552800, (27.2, 1007.6, 68.3), 'NORMAL'),
    (4, 1609556400, (26.4, 1003.2, 64.9), 'OK'),
    (5, 1609560000, (25.9, 1006.5, 58.6), 'NORMAL'),
    (6, 1609563600, (24.7, 1002.8, 52.3), 'ALERT'),
    (7, 1609567200, (23.5, 1008.4, 47.1), 'NORMAL'),
    (8, 1609570800, (22.8, 1005.3, 44.8), 'OK'),
    
    # Additional duplicate
    (5, 1609574400, (21.7, 1004.6, 39.5), 'NORMAL'),
    (5, 1609574400, (21.7, 1004.6, 39.5), 'NORMAL'),  # Duplicate
    
    # More records filling up to around 65
    (3, 1609578000, (20.9, 1007.1, 42.7), 'OK'),
    (4, 1609581600, (22.3, 1003.9, 46.2), 'NORMAL'),
    (5, 1609585200, (23.6, 1006.2, 51.9), 'ALERT'),
    (6, 1609588800, (25.4, 1002.5, 57.6), 'NORMAL'),
    (7, 1609592400, (26.1, 1008.1, 63.4), 'OK'),
    (8, 1609596000, (24.9, 1004.8, 54.2), 'NORMAL'),
    (3, 1609599600, (23.2, 1007.4, 49.7), 'OK'),
    (4, 1609603200, (21.6, 1003.6, 43.9), 'NORMAL'),
    (5, 1609606800, (22.7, 1006.9, 48.3), 'ALERT'),
    (6, 1609610400, (24.2, 1002.1, 53.8), 'OK'),
    (7, 1609614000, (25.8, 1008.6, 60.5), 'NORMAL'),
    (8, 1609617600, (27.1, 1005.7, 66.2), 'OK'),
    
    # Whitespace status entries
    (3, 1609621200, (26.5, 1004.4, 61.8), ' '),  # Whitespace
    (4, 1609624800, (25.2, 1007.8, 57.4), '  '),  # Whitespace
    
    # More records
    (5, 1609628400, (24.0, 1003.1, 50.9), 'NORMAL'),
    (6, 1609632000, (23.1, 1006.6, 46.5), 'OK'),
    (7, 1609635600, (22.4, 1002.7, 41.8), 'ALERT'),
    (8, 1609639200, (21.8, 1008.3, 38.2), 'NORMAL'),
    (3, 1609642800, (20.5, 1005.2, 35.6), 'OK'),
    (4, 1609646400, (19.7, 1004.9, 32.1), 'NORMAL'),
    (5, 1609650000, (18.9, 1007.7, 28.5), 'ALERT'),
    (6, 1609653600, (19.5, 1003.4, 30.7), 'OK'),
    (7, 1609657200, (20.1, 1006.3, 34.2), 'NORMAL'),
    (8, 1609660800, (21.0, 1002.9, 37.8), 'OK'),
    (3, 1609664400, (22.2, 1008.5, 44.1), 'NORMAL'),
]

# Create the structured array
structured_array = np.array(data, dtype=dtype)

# Save to file
np.save('/tmp/experiment_002.npy', structured_array)

print(f"Generated experiment_002.npy with {len(structured_array)} records")