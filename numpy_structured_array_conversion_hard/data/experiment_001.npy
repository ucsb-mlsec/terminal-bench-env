import numpy as np

# Define the dtype for the structured array
dtype = [
    ('sensor_id', 'i4'),
    ('timestamp', 'i8'),
    ('reading', [('temperature', 'f4'), ('pressure', 'f4'), ('humidity', 'f4')]),
    ('status', 'U10')
]

# Create data with the specified characteristics
data = [
    # Normal records
    (1, 1609459200, (22.5, 1013.2, 45.3), 'OK'),
    (2, 1609459200, (23.1, 1012.8, 48.7), 'OK'),
    (3, 1609459200, (21.8, 1014.1, 52.1), 'OK'),
    (1, 1609462800, (22.8, 1013.5, 46.2), 'OK'),
    (2, 1609462800, (23.4, 1012.5, 49.1), 'OK'),
    
    # Invalid temperature readings (-999.0)
    (3, 1609462800, (-999.0, 1014.3, 53.4), 'ERROR'),
    (4, 1609466400, (-999.0, 1011.2, 55.8), 'ERROR'),
    (5, 1609466400, (-999.0, 1015.7, 42.3), 'WARNING'),
    (1, 1609470000, (-999.0, 1013.8, 47.5), 'ERROR'),
    (2, 1609470000, (-999.0, 1012.9, 50.2), 'ERROR'),
    (3, 1609470000, (-999.0, 1014.6, 54.1), 'ERROR'),
    
    # Clock failures (timestamp = 0)
    (4, 0, (24.2, 1011.5, 56.2), 'WARNING'),
    (5, 0, (25.1, 1015.9, 43.1), 'OK'),
    (1, 0, (22.3, 1013.1, 44.8), 'OK'),
    
    # Records with whitespace or empty status
    (2, 1609473600, (23.7, 1012.3, 51.3), '  '),
    (3, 1609473600, (21.5, 1014.8, 55.6), ''),
    (4, 1609473600, (24.5, 1011.8, 57.9), '   '),
    
    # More normal records
    (5, 1609477200, (25.4, 1016.2, 44.5), 'OK'),
    (1, 1609477200, (22.1, 1013.4, 45.1), 'OK'),
    (2, 1609477200, (23.2, 1012.6, 49.8), 'WARNING'),
    (3, 1609480800, (21.9, 1014.4, 53.9), 'OK'),
    (4, 1609480800, (24.8, 1012.1, 58.3), 'OK'),
    (5, 1609480800, (25.7, 1016.5, 45.2), 'OK'),
    
    # Duplicate records (same sensor_id and timestamp)
    (1, 1609484400, (22.6, 1013.7, 46.8), 'OK'),
    (1, 1609484400, (22.6, 1013.7, 46.8), 'OK'),  # Duplicate
    (2, 1609484400, (23.5, 1012.4, 50.5), 'OK'),
    (2, 1609484400, (23.5, 1012.4, 50.5), 'OK'),  # Duplicate
    (3, 1609484400, (22.0, 1014.7, 54.8), 'WARNING'),
    (3, 1609484400, (22.0, 1014.7, 54.8), 'WARNING'),  # Duplicate
    
    # More records with various conditions
    (4, 1609488000, (24.9, 1012.3, 59.1), 'OK'),
    (5, 1609488000, (26.0, 1016.8, 46.4), 'OK'),
    (1, 1609491600, (22.9, 1014.0, 47.3), 'OK'),
    (2, 1609491600, (23.8, 1012.1, 51.2), 'OK'),
    (3, 1609491600, (22.3, 1015.0, 55.4), 'OK'),
    
    # Additional duplicate
    (4, 1609495200, (25.2, 1012.6, 60.2), 'WARNING'),
    (4, 1609495200, (25.2, 1012.6, 60.2), 'WARNING'),  # Duplicate
    
    # More normal and edge case records
    (5, 1609495200, (26.3, 1017.1, 47.8), 'OK'),
    (1, 1609498800, (23.1, 1014.3, 48.1), 'OK'),
    (2, 1609498800, (24.1, 1011.9, 52.4), 'OK'),
    (3, 1609498800, (22.6, 1015.3, 56.2), ''),
    (4, 1609502400, (25.5, 1012.9, 61.5), 'OK'),
    (5, 1609502400, (26.6, 1017.4, 48.9), 'OK'),
    
    # Additional records to reach 60-80 range
    (1, 1609506000, (23.4, 1014.6, 49.2), 'OK'),
    (2, 1609506000, (24.4, 1011.7, 53.1), 'WARNING'),
    (3, 1609506000, (22.9, 1015.6, 57.3), 'OK'),
    (4, 1609509600, (25.8, 1013.2, 62.8), 'OK'),
    (5, 1609509600, (26.9, 1017.7, 50.1), 'OK'),
    (1, 1609513200, (23.7, 1014.9, 50.3), 'OK'),
    (2, 1609513200, (24.7, 1011.5, 54.2), 'OK'),
    (3, 1609513200, (23.2, 1015.9, 58.5), 'OK'),
    (4, 1609516800, (26.1, 1013.5, 64.1), 'ERROR'),
    (5, 1609516800, (27.2, 1018.0, 51.4), 'OK'),
    
    (1, 1609520400, (24.0, 1015.2, 51.5), 'OK'),
    (2, 1609520400, (25.0, 1011.3, 55.3), 'OK'),
    (3, 1609520400, (23.5, 1016.2, 59.7), 'WARNING'),
    (4, 1609524000, (26.4, 1013.8, 65.4), 'OK'),
    (5, 1609524000, (27.5, 1018.3, 52.7), 'OK'),
    (1, 1609527600, (24.3, 1015.5, 52.8), 'OK'),
    (2, 1609527600, (25.3, 1011.1, 56.4), 'OK'),
    (3, 1609527600, (23.8, 1016.5, 61.2), 'OK'),
    (4, 1609531200, (26.7, 1014.1, 66.7), 'OK'),
    (5, 1609531200, (27.8, 1018.6, 54.0), 'OK'),
    
    (1, 1609534800, (24.6, 1015.8, 54.1), 'OK'),
    (2, 1609534800, (25.6, 1010.9, 57.5), 'OK'),
    (3, 1609534800, (24.1, 1016.8, 62.7), 'OK'),
    (4, 1609538400, (27.0, 1014.4, 68.0), 'WARNING'),
    (5, 1609538400, (28.1, 1018.9, 55.3), 'OK'),
    (1, 1609542000, (24.9, 1016.1, 55.4), 'OK'),
    (2, 1609542000, (25.9, 1010.7, 58.6), 'OK'),
    (3, 1609542000, (24.4, 1017.1, 64.2), 'OK'),
]

# Convert to structured array
structured_array = np.array(data, dtype=dtype)

# Save to file
np.save('/data/experiments/experiment_001.npy', structured_array)