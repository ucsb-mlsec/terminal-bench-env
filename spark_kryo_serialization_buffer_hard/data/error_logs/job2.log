2024-01-16 14:12:33 INFO SparkContext: Running Spark version 3.4.1
2024-01-16 14:12:33 INFO ResourceUtils: ==============================================================
2024-01-16 14:12:33 INFO ResourceUtils: No custom resources configured for spark.driver.
2024-01-16 14:12:33 INFO ResourceUtils: ==============================================================
2024-01-16 14:12:34 INFO SparkContext: Submitted application: DataProcessingJob2
2024-01-16 14:12:34 INFO SecurityManager: Changing view acls to: spark
2024-01-16 14:12:34 INFO SecurityManager: Changing modify acls to: spark
2024-01-16 14:12:35 INFO Utils: Successfully started service 'sparkDriver' on port 42857
2024-01-16 14:12:35 INFO SparkEnv: Registering MapOutputTracker
2024-01-16 14:12:35 INFO SparkEnv: Registering BlockManagerMaster
2024-01-16 14:12:36 INFO BlockManagerMasterEndpoint: Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2024-01-16 14:12:36 INFO BlockManagerMasterEndpoint: BlockManagerMasterEndpoint up
2024-01-16 14:12:36 INFO SparkEnv: Registering OutputCommitCoordinator
2024-01-16 14:12:37 INFO JettyUtils: Start Jetty 0.0.0.0:4040 for SparkUI
2024-01-16 14:12:37 INFO Utils: Successfully started service 'SparkUI' on port 4040
2024-01-16 14:12:38 INFO StandaloneAppClient$ClientEndpoint: Connecting to master spark://master:7077
2024-01-16 14:12:38 INFO TransportClientFactory: Successfully created connection to master/10.0.1.5:7077 after 45 ms
2024-01-16 14:12:39 INFO StandaloneSchedulerBackend: Connected to Spark cluster with app ID app-20240116141239-0002
2024-01-16 14:12:39 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 38291
2024-01-16 14:12:39 INFO StandaloneAppClient$ClientEndpoint: Executor added: app-20240116141239-0002/0 on worker-20240116105234-10.0.1.12-41223
2024-01-16 14:12:39 INFO StandaloneSchedulerBackend: Granted executor ID app-20240116141239-0002/0 on hostPort 10.0.1.12:41223 with 4 core(s), 8.0 GiB RAM
2024-01-16 14:12:40 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(driver, spark-driver, 38291, None)
2024-01-16 14:12:40 INFO BlockManagerMasterEndpoint: Registering block manager spark-driver:38291 with 2.5 GiB RAM
2024-01-16 14:12:40 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(driver, spark-driver, 38291, None)
2024-01-16 14:12:41 INFO StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio: 0.0
2024-01-16 14:12:42 INFO DAGScheduler: Got job 0 (processData at DataProcessor.scala:178) with 24 output partitions
2024-01-16 14:12:42 INFO DAGScheduler: Final stage: ResultStage 0 (processData at DataProcessor.scala:178)
2024-01-16 14:12:42 INFO DAGScheduler: Parents of final stage: List()
2024-01-16 14:12:42 INFO DAGScheduler: Missing parents: List()
2024-01-16 14:12:42 INFO DAGScheduler: Submitting ResultStage 0 (MapPartitionsRDD[3] at processData at DataProcessor.scala:178), which has no missing parents
2024-01-16 14:12:43 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 142.3 KiB, free 2.5 GiB)
2024-01-16 14:12:43 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 62.1 KiB, free 2.5 GiB)
2024-01-16 14:12:43 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on spark-driver:38291 (size: 62.1 KiB, free: 2.5 GiB)
2024-01-16 14:12:43 INFO SparkContext: Created broadcast 0 from broadcast at DAGScheduler.scala:1535
2024-01-16 14:12:43 INFO DAGScheduler: Submitting 24 missing tasks from ResultStage 0 (MapPartitionsRDD[3] at processData at DataProcessor.scala:178)
2024-01-16 14:12:43 INFO TaskSchedulerImpl: Adding task set 0.0 with 24 tasks resource profile 0
2024-01-16 14:12:43 INFO TaskSetManager: Starting task 0.0 in stage 0.0 (TID 0) (10.0.1.12, executor 0, partition 0, PROCESS_LOCAL, 4829 bytes)
2024-01-16 14:12:44 INFO TaskSetManager: Starting task 1.0 in stage 0.0 (TID 1) (10.0.1.12, executor 0, partition 1, PROCESS_LOCAL, 4829 bytes)
2024-01-16 14:12:44 INFO TaskSetManager: Starting task 2.0 in stage 0.0 (TID 2) (10.0.1.12, executor 0, partition 2, PROCESS_LOCAL, 4829 bytes)
2024-01-16 14:12:45 INFO BlockManagerInfo: Added broadcast_0_piece0 in memory on 10.0.1.12:43589 (size: 62.1 KiB, free: 7.9 GiB)
2024-01-16 14:12:47 ERROR Executor: Exception in task 0.0 in stage 0.0 (TID 0)
org.apache.spark.SparkException: Task failed while writing rows
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1538)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.spark.SparkException: Kryo serialization failed: Buffer overflow. Available: 65536, required: 152847
	at org.apache.spark.serializer.KryoSerializerInstance.serialize(KryoSerializer.scala:370)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$12(Executor.scala:558)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1538)
	... 4 more
Caused by: com.esotericsoftware.kryo.KryoException: Buffer overflow. Available: 65536, required: 152847
Serialization trace:
userData (com.example.spark.model.UserProfile)
	at com.esotericsoftware.kryo.io.Output.require(Output.java:167)
	at com.esotericsoftware.kryo.io.Output.writeBytes(Output.java:251)
	at com.esotericsoftware.kryo.io.Output.writeString(Output.java:898)
	at com.esotericsoftware.kryo.serializers.DefaultSerializers$StringSerializer.write(DefaultSerializers.java:208)
	at com.esotericsoftware.kryo.Kryo.writeObject(Kryo.java:726)
	at org.apache.spark.serializer.KryoSerializerInstance.serialize(KryoSerializer.scala:367)
	... 6 more
2024-01-16 14:12:47 WARN TaskSetManager: Lost task 0.0 in stage 0.0 (TID 0) (10.0.1.12 executor 0): org.apache.spark.SparkException: Kryo serialization failed: Buffer overflow. Available: 65536, required: 152847
2024-01-16 14:12:47 ERROR TaskSchedulerImpl: Lost executor 0 on 10.0.1.12: The executor with id 0 exited with exit code 1
2024-01-16 14:12:47 INFO DAGScheduler: ShuffleMapStage 0 (processData at DataProcessor.scala:178) failed in 4.127 s due to Job aborted due to stage failure: Task 0 in stage 0.0 failed 1 times
2024-01-16 14:12:47 ERROR SparkContext: Error running job: org.apache.spark.SparkException: Job aborted due to stage failure
2024-01-16 14:12:47 INFO SparkContext: Invoking stop() from shutdown hook
2024-01-16 14:12:48 INFO SparkUI: Stopped Spark web UI at http://spark-driver:4040