#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <errno.h>

#define MAX_INPUT_LEN 256
#define MAX_LOG_LEN 512

/* Safe module - demonstrates proper format string usage */

void safe_print(const char *user_input) {
    if (user_input == NULL) {
        fprintf(stderr, "%s\n", "Error: NULL input provided");
        return;
    }
    printf("%s\n", user_input);
}

void validated_output(const char *message, int code) {
    if (message == NULL) {
        return;
    }
    fprintf(stdout, "Code %d: %s\n", code, message);
}

void secure_log(const char *component, const char *user_data) {
    if (component == NULL || user_data == NULL) {
        fprintf(stderr, "%s\n", "Invalid log parameters");
        return;
    }
    fprintf(stderr, "[%s] %s\n", component, user_data);
}

int safe_error_handler(const char *operation, int error_code) {
    const char *error_msg = strerror(error_code);
    fprintf(stderr, "Operation '%s' failed with error %d: %s\n", 
            operation, error_code, error_msg);
    return -1;
}

void print_user_profile(const char *username, const char *email) {
    if (username == NULL || email == NULL) {
        printf("%s\n", "Invalid profile data");
        return;
    }
    printf("Username: %s\n", username);
    printf("Email: %s\n", email);
}

void display_status(int status_code, const char *status_msg) {
    printf("Status: %d - %s\n", status_code, status_msg);
}

void log_authentication(const char *user, int success) {
    if (user == NULL) {
        return;
    }
    if (success) {
        fprintf(stderr, "AUTH SUCCESS: User %s logged in\n", user);
    } else {
        fprintf(stderr, "AUTH FAILURE: User %s login failed\n", user);
    }
}

void print_formatted_data(const char *label, const char *data) {
    printf("%s: %s\n", label, data);
}

int main(int argc, char *argv[]) {
    char buffer[MAX_INPUT_LEN];
    
    if (argc > 1) {
        safe_print(argv[1]);
    }
    
    printf("%s", "Enter your name: ");
    if (fgets(buffer, sizeof(buffer), stdin) != NULL) {
        buffer[strcspn(buffer, "\n")] = 0;
        validated_output(buffer, 200);
    }
    
    secure_log("MAIN", "Application started successfully");
    
    print_user_profile("john_doe", "john@example.com");
    display_status(0, "System operational");
    log_authentication("admin", 1);
    
    return 0;
}