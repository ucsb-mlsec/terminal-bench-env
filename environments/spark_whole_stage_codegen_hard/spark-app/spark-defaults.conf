# Spark Configuration for Financial Transaction Analyzer
# Production Environment Settings

# Application Identity
spark.app.name FinancialTransactionAnalyzer
spark.master yarn
spark.submit.deployMode cluster

# Resource Allocation
spark.executor.memory 8g
spark.driver.memory 4g
spark.executor.cores 4
spark.executor.instances 20
spark.default.parallelism 160

# Memory Management
spark.memory.fraction 0.8
spark.memory.storageFraction 0.3
spark.executor.memoryOverhead 1024

# Shuffle and Network
spark.shuffle.service.enabled true
spark.shuffle.compress true
spark.shuffle.spill.compress true
spark.network.timeout 300s
spark.executor.heartbeatInterval 20s

# SQL Optimization Settings
spark.sql.adaptive.enabled true
spark.sql.adaptive.coalescePartitions.enabled true
spark.sql.shuffle.partitions 400
spark.sql.autoBroadcastJoinThreshold 10485760

# Code Generation Settings
spark.sql.codegen.wholeStage true
spark.sql.codegen.factoryMode CODEGEN_ONLY
spark.sql.codegen.comments false

# Serialization
spark.serializer org.apache.spark.serializer.KryoSerializer
spark.kryoserializer.buffer.max 512m

# Dynamic Allocation
spark.dynamicAllocation.enabled true
spark.dynamicAllocation.minExecutors 5
spark.dynamicAllocation.maxExecutors 50