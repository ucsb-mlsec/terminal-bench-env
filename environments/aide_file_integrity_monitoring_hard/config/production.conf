# AIDE configuration file for production web servers
# This configuration monitors critical system files and web application directories
# Maintained by: Security Operations Team
# Last updated: 2024-01-15

# Database and report paths
database=file:/var/lib/aide/aide.db
database_out=file:/var/lib/aide/aide.db.new
report_url=file:/var/log/aide/aide.log

# Custom rule definitions
R = p+i+u+g+s+m+c+sha256
L = p+i+u+g
N = p+i+u+g+s+sha256+acl+xattrs

# System binaries - monitor everything
/bin R
/sbin R
/usr/bin R
/usr/sbin R

# Critical system configuration
/etc N

# Exclude shadow file from monitoring - managed separately
!/etc/shadow

# Boot directory - kernel and initrd
!/boot

# Web server configurations
/etc/apache2 N
/etc/nginx N
/etc/php N

# Web application directories
/var/www R
/var/www/html N

# Library directories
/lib R
/lib64 R
/usr/lib R

# Exclude temporary and cache directories
!/var/tmp
!/tmp
!/var/cache

# System logs - monitor directory structure only
/var/log L

# Malformed rule - missing attributes specification
/opt/applications

# User home directories for service accounts
/home/www-data L

# SSL certificates and keys
/etc/ssl N
/etc/pki N