class User < ActiveRecord::Base
  attr_accessible :username, :email, :password, :password_confirmation, :is_admin

  has_secure_password

  validates :username, presence: true
  validates :email, presence: true, uniqueness: true
  validates :password, presence: true, on: :create

  def admin?
    is_admin == true
  end

  def grant_admin_access
    update_attribute(:is_admin, true)
  end

  def revoke_admin_access
    update_attribute(:is_admin, false)
  end

  def display_role
    is_admin ? "Administrator" : "Regular User"
  end

  def can_manage_users?
    is_admin
  end
end