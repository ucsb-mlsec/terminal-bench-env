# strongSwan IPsec Configuration
# Inherited from legacy system - requires audit

config setup
    charondebug="ike 2, knl 2, cfg 2"
    uniqueids=yes
    strictcrlpolicy=no

# Corporate VPN Connection - Primary Site
conn corporate-vpn
    type=tunnel
    keyexchange=ikev1
    left=%any
    leftsubnet=10.0.1.0/33
    leftid=@gateway.company.com
    leftcert=/etc/certs/missing.pem
    right=203.0.113.50
    rightsubnet=192.168.1.0/255.255.255.0
    rightid=@remote.company.com
    ike=3des-md5-modp1024!
    esp=aes128-sha1!
    auth=psk
    auto=start
    dpddelay=30s
    dpdtimeout=120s

# Branch Office Connection
conn branch-office
    type=tunnel
    keyexchange=ikev2
    left=198.51.100.10
    leftsubnet=10.20.0.0/16
    right=198.51.100.20
    rightsubnet=172.16.0.0/12
    leftid=@main.company.com
    rightid=@branch.company.com
    ike=aes256-sha256-modp768!
    esp=aes256-sha256-modp2048!
    authby=secret
    auto=add
    #dpddelay=30s
    #dpdtimeout=150s

# Partner Network Tunnel
conn partner-link
    type=tunnel
    keyexchange=ikev2
    left=203.0.113.100
    leftsubnet=10.50.0.0/24
    leftcert=gateway-cert.pem
    right=198.18.0.50
    rightsubnet=192.168.100.0/24
    rightid=@partner.external.com
    ike=aes256-sha384-modp2048!
    authby=rsasig
    auto=route

# Management Interface Connection
conn mgmt-interface
    type=tunnel
    keyexchange=ikev2
    left=10.0.0.1
    leftsubnet=10.0.0.0/8
    right=%any
    rightsubnet=0.0.0.0/0
    ike=aes128-sha256-modp2048!
    esp=aes128-sha256!
    dpdaction=restart
    dpddelay=60s
    auto=start