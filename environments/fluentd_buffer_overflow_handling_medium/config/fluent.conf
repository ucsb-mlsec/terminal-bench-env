<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

<match application.**>
  @type elasticsearch
  host elasticsearch.internal
  port 9200
  logstash_format true
  logstash_prefix fluentd
  include_tag_key true
  
  <buffer>
    @type file
    path /var/log/fluentd/buffer
    buffer_chunk_limit 2m
    buffer_queue_limit 4
    flush_interval 30s
    flush_mode interval
    retry_type exponential_backoff
    retry_wait 10s
    retry_max_interval 300s
  </buffer>
</match>

<match system.**>
  @type file
  path /var/log/fluentd/output/system.log
  
  <buffer>
    buffer_chunk_limit 1m
    buffer_queue_limit 2
    flush_interval 60s
  </buffer>
</match>