2024-01-15 10:15:23 INFO [SparkContext]: Starting Spark application job_20240115_101523_0847
2024-01-15 10:15:23 INFO [DAGScheduler]: Got job 0 (reduce at Application.scala:156) with 5 output partitions
2024-01-15 10:15:24 INFO [DAGScheduler]: Submitting 5 stages (0, 1, 2, 3, 4) with 10000 total tasks
2024-01-15 10:15:24 INFO [TaskSetManager]: Starting task set 0.0 with 2000 tasks
2024-01-15 10:15:25 INFO [Executor]: Running task 0.0 in stage 0.0 (TID 0)
2024-01-15 10:15:26 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_0/partition_0/shuffle_0_0_0.data
2024-01-15 10:15:26 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_0/partition_1/shuffle_0_1_0.data
2024-01-15 10:15:27 INFO [ShuffleBlockManager]: Created shuffle file for shuffle_0_2_0 at /opt/spark/shuffle_data/stage_0/partition_2
2024-01-15 10:15:27 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_0_0_0.data, size: 6.2 MB
2024-01-15 10:15:28 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_0_1_0.data, size: 5.4 MB
2024-01-15 10:15:28 INFO [Executor]: Finished task 0.0 in stage 0.0 (TID 0). 6543210 bytes result sent to driver
2024-01-15 10:15:29 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_0/partition_3/shuffle_0_3_0.data
2024-01-15 10:15:29 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_0/partition_4/shuffle_0_4_0.data
2024-01-15 10:15:30 WARN [TaskSetManager]: Stage 0 is creating excessive shuffle files. Current count: 2000
2024-01-15 10:15:31 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_0_3_0.data, size: 4.8 MB
2024-01-15 10:15:31 INFO [ShuffleBlockManager]: Created shuffle file for shuffle_0_5_0 at /opt/spark/shuffle_data/stage_0/partition_5
2024-01-15 10:15:32 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_0/partition_6/shuffle_0_6_0.data
2024-01-15 10:15:33 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_0_4_0.data, size: 7.1 MB
2024-01-15 10:15:34 INFO [TaskSetManager]: Finished task set 0.0 in 10.2 s (executor compute time: 8.5 s, shuffle write time: 1.7 s)
2024-01-15 10:15:34 INFO [DAGScheduler]: Stage 0 finished with 2000 partitions
2024-01-15 10:15:34 INFO [DAGScheduler]: Shuffle Write: 11.4 GB across 2000 files
2024-01-15 10:15:35 WARN [ShuffleManager]: Stage 0 completed with 2000 shuffle files, avg file size: 5.8 MB
2024-01-15 10:15:35 INFO [DAGScheduler]: Submitting Stage 1 (MapPartitionsRDD[2] at map at Application.scala:89)
2024-01-15 10:15:36 INFO [TaskSetManager]: Starting task set 1.0 with 2000 tasks
2024-01-15 10:15:37 INFO [Executor]: Running task 1.0 in stage 1.0 (TID 2000)
2024-01-15 10:15:38 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_1/partition_0/shuffle_1_0_0.data
2024-01-15 10:15:38 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_1/partition_1/shuffle_1_1_0.data
2024-01-15 10:15:39 INFO [ShuffleBlockManager]: Created shuffle file for shuffle_1_2_0 at /opt/spark/shuffle_data/stage_1/partition_2
2024-01-15 10:15:40 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_1_0_0.data, size: 6.8 MB
2024-01-15 10:15:41 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_1/partition_3/shuffle_1_3_0.data
2024-01-15 10:15:41 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_1_1_0.data, size: 5.2 MB
2024-01-15 10:15:42 INFO [Executor]: Finished task 1.0 in stage 1.0 (TID 2000). 5892341 bytes result sent to driver
2024-01-15 10:15:43 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_1/partition_4/shuffle_1_4_0.data
2024-01-15 10:15:44 WARN [TaskSetManager]: Stage 1 is creating excessive shuffle files. Current count: 1500
2024-01-15 10:15:45 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_1_3_0.data, size: 6.4 MB
2024-01-15 10:15:46 INFO [ShuffleBlockManager]: Created shuffle file for shuffle_1_5_0 at /opt/spark/shuffle_data/stage_1/partition_5
2024-01-15 10:15:47 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_1/partition_6/shuffle_1_6_0.data
2024-01-15 10:15:48 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_1_4_0.data, size: 5.9 MB
2024-01-15 10:15:49 INFO [TaskSetManager]: Finished task set 1.0 in 13.5 s (executor compute time: 10.2 s, shuffle write time: 3.3 s)
2024-01-15 10:15:49 INFO [DAGScheduler]: Stage 1 finished with 2000 partitions
2024-01-15 10:15:50 INFO [DAGScheduler]: Shuffle Write: 12.1 GB across 2000 files
2024-01-15 10:15:50 WARN [ShuffleManager]: Stage 1 completed with 2000 shuffle files, avg file size: 6.2 MB
2024-01-15 10:15:51 WARN [FileSystem]: High number of small files detected in /opt/spark/shuffle_data/. Total files: 4000
2024-01-15 10:15:51 INFO [DAGScheduler]: Submitting Stage 2 (MapPartitionsRDD[3] at map at Application.scala:112)
2024-01-15 10:15:52 INFO [TaskSetManager]: Starting task set 2.0 with 2000 tasks
2024-01-15 10:15:53 INFO [Executor]: Running task 2.0 in stage 2.0 (TID 4000)
2024-01-15 10:15:54 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_2/partition_0/shuffle_2_0_0.data
2024-01-15 10:15:54 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_2/partition_1/shuffle_2_1_0.data
2024-01-15 10:15:55 INFO [ShuffleBlockManager]: Created shuffle file for shuffle_2_2_0 at /opt/spark/shuffle_data/stage_2/partition_2
2024-01-15 10:15:56 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_2_0_0.data, size: 5.5 MB
2024-01-15 10:15:57 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_2/partition_3/shuffle_2_3_0.data
2024-01-15 10:15:57 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_2_1_0.data, size: 4.9 MB
2024-01-15 10:15:58 INFO [Executor]: Finished task 2.0 in stage 2.0 (TID 4000). 6234567 bytes result sent to driver
2024-01-15 10:15:59 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_2/partition_4/shuffle_2_4_0.data
2024-01-15 10:16:00 WARN [TaskSetManager]: Stage 2 is creating excessive shuffle files. Current count: 1800
2024-01-15 10:16:01 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_2_3_0.data, size: 6.7 MB
2024-01-15 10:16:02 INFO [ShuffleBlockManager]: Created shuffle file for shuffle_2_5_0 at /opt/spark/shuffle_data/stage_2/partition_5
2024-01-15 10:16:03 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_2/partition_7/shuffle_2_7_0.data
2024-01-15 10:16:04 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_2_4_0.data, size: 5.3 MB
2024-01-15 10:16:05 INFO [TaskSetManager]: Finished task set 2.0 in 13.8 s (executor compute time: 10.8 s, shuffle write time: 3.0 s)
2024-01-15 10:16:05 INFO [DAGScheduler]: Stage 2 finished with 2000 partitions
2024-01-15 10:16:06 INFO [DAGScheduler]: Shuffle Write: 11.8 GB across 2000 files
2024-01-15 10:16:06 WARN [ShuffleManager]: Stage 2 completed with 2000 shuffle files, avg file size: 6.0 MB
2024-01-15 10:16:07 WARN [FileSystem]: Critical: Total shuffle files now at 6000, causing I/O degradation
2024-01-15 10:16:08 INFO [DAGScheduler]: Submitting Stage 3 (MapPartitionsRDD[4] at reduce at Application.scala:134)
2024-01-15 10:16:09 INFO [TaskSetManager]: Starting task set 3.0 with 1000 tasks
2024-01-15 10:16:10 INFO [Executor]: Running task 3.0 in stage 3.0 (TID 6000)
2024-01-15 10:16:11 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_3/partition_0/shuffle_3_0_0.data
2024-01-15 10:16:11 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_3/partition_1/shuffle_3_1_0.data
2024-01-15 10:16:12 INFO [ShuffleBlockManager]: Created shuffle file for shuffle_3_2_0 at /opt/spark/shuffle_data/stage_3/partition_2
2024-01-15 10:16:13 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_3_0_0.data, size: 7.3 MB
2024-01-15 10:16:14 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_3/partition_3/shuffle_3_3_0.data
2024-01-15 10:16:14 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_3_1_0.data, size: 6.1 MB
2024-01-15 10:16:15 INFO [Executor]: Finished task 3.0 in stage 3.0 (TID 6000). 7123456 bytes result sent to driver
2024-01-15 10:16:16 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_3/partition_4/shuffle_3_4_0.data
2024-01-15 10:16:17 WARN [TaskSetManager]: Stage 3 is creating excessive shuffle files. Current count: 900
2024-01-15 10:16:18 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_3_3_0.data, size: 5.7 MB
2024-01-15 10:16:19 INFO [ShuffleBlockManager]: Created shuffle file for shuffle_3_5_0 at /opt/spark/shuffle_data/stage_3/partition_5
2024-01-15 10:16:20 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_3/partition_6/shuffle_3_6_0.data
2024-01-15 10:16:21 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_3_4_0.data, size: 6.8 MB
2024-01-15 10:16:22 INFO [TaskSetManager]: Finished task set 3.0 in 13.2 s (executor compute time: 10.1 s, shuffle write time: 3.1 s)
2024-01-15 10:16:22 INFO [DAGScheduler]: Stage 3 finished with 1000 partitions
2024-01-15 10:16:23 INFO [DAGScheduler]: Shuffle Write: 6.2 GB across 1000 files
2024-01-15 10:16:23 WARN [ShuffleManager]: Stage 3 completed with 1000 shuffle files, avg file size: 6.4 MB
2024-01-15 10:16:24 WARN [FileSystem]: Total shuffle files now at 7000, performance severely impacted
2024-01-15 10:16:25 INFO [DAGScheduler]: Submitting Stage 4 (MapPartitionsRDD[5] at reduce at Application.scala:156)
2024-01-15 10:16:26 INFO [TaskSetManager]: Starting task set 4.0 with 1000 tasks
2024-01-15 10:16:27 INFO [Executor]: Running task 4.0 in stage 4.0 (TID 7000)
2024-01-15 10:16:28 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_4/partition_0/shuffle_4_0_0.data
2024-01-15 10:16:28 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_4/partition_1/shuffle_4_1_0.data
2024-01-15 10:16:29 INFO [ShuffleBlockManager]: Created shuffle file for shuffle_4_2_0 at /opt/spark/shuffle_data/stage_4/partition_2
2024-01-15 10:16:30 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_4_0_0.data, size: 4.2 MB
2024-01-15 10:16:31 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_4/partition_3/shuffle_4_3_0.data
2024-01-15 10:16:31 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_4_1_0.data, size: 3.9 MB
2024-01-15 10:16:32 INFO [Executor]: Finished task 4.0 in stage 4.0 (TID 7000). 4567890 bytes result sent to driver
2024-01-15 10:16:33 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_4/partition_4/shuffle_4_4_0.data
2024-01-15 10:16:34 WARN [TaskSetManager]: Stage 4 is creating excessive shuffle files. Current count: 850
2024-01-15 10:16:35 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_4_3_0.data, size: 4.6 MB
2024-01-15 10:16:36 INFO [ShuffleBlockManager]: Created shuffle file for shuffle_4_5_0 at /opt/spark/shuffle_data/stage_4/partition_5
2024-01-15 10:16:37 DEBUG [ShuffleWriter]: Creating shuffle file /opt/spark/shuffle_data/stage_4/partition_6/shuffle_4_6_0.data
2024-01-15 10:16:38 DEBUG [ShuffleWriter]: Finished writing shuffle file shuffle_4_4_0.data, size: 4.1 MB
2024-01-15 10:16:39 INFO [TaskSetManager]: Finished task set 4.0 in 13.5 s (executor compute time: 10.3 s, shuffle write time: 3.2 s)
2024-01-15 10:16:39 INFO [DAGScheduler]: Stage 4 finished with 1000 partitions
2024-01-15 10:16:40 INFO [DAGScheduler]: Shuffle Write: 4.3 GB across 1000 files
2024-01-15 10:16:40 WARN [ShuffleManager]: Stage 4 completed with 1000 shuffle files, avg file size: 4.4 MB
2024-01-15 10:16:41 INFO [DAGScheduler]: Job 0 finished: reduce at Application.scala:156, took 386.234 s
2024-01-15 10:16:41 WARN [SparkContext]: Application generated 8000 total shuffle files
2024-01-15 10:16:42 INFO [DAGScheduler]: Total Shuffle Write across all stages: 45.8 GB
2024-01-15 10:16:42 WARN [ShuffleManager]: Shuffle Files Created: 8000, Avg file size: 5.8 MB
2024-01-15 10:16:43 WARN [FileSystem]: Recommend enabling spark.shuffle.consolidateFiles to reduce file count
2024-01-15 10:16:43 WARN [FileSystem]: Consider reducing spark.sql.shuffle.partitions from current default
2024-01-15 10:16:44 INFO [SparkContext]: Application job_20240115_101523_0847 completed