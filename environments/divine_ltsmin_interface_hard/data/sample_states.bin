#!/usr/bin/env python3

import struct
import sys

def generate_sample_states():
    """
    Generate sample_states.bin with INCORRECT format (includes padding after status flag)
    
    Current INCORRECT format per record:
    - state_id: 4-byte integer (I)
    - timestamp: 4-byte float (f)
    - status: 1-byte flag (B)
    - padding: 3 bytes (xxx) - THIS IS THE PROBLEM
    - value: 8-byte double (d)
    - count: 4-byte integer (I)
    Total: 24 bytes per record
    """
    
    records = [
        (1001, 1.5, 0x01, 123.456, 10),
        (1002, 2.3, 0x00, 234.567, 20),
        (1003, 3.7, 0x01, 345.678, 15),
        (1004, 4.2, 0x01, 456.789, 25),
        (1005, 5.8, 0x00, 567.890, 30),
        (1006, 6.1, 0x01, 678.901, 12),
        (1007, 7.4, 0x00, 789.012, 18),
        (1008, 8.9, 0x01, 890.123, 22),
        (1009, 9.3, 0x01, 901.234, 28),
        (1010, 10.7, 0x00, 112.345, 35),
        (1011, 11.2, 0x01, 223.456, 40),
        (1012, 12.6, 0x00, 334.567, 16),
        (1013, 13.1, 0x01, 445.678, 19),
        (1014, 14.8, 0x01, 556.789, 24),
        (1015, 15.4, 0x00, 667.890, 31),
    ]
    
    with open('/workspace/state-exchange/sample_states.bin', 'wb') as f:
        for state_id, timestamp, status, value, count in records:
            # Pack with padding (INCORRECT format)
            # Format: I (4 bytes) + f (4 bytes) + B (1 byte) + xxx (3 bytes padding) + d (8 bytes) + I (4 bytes)
            data = struct.pack('<If', state_id, timestamp)
            data += struct.pack('<B', status)
            data += b'\x00\x00\x00'  # 3 bytes of padding - THE PROBLEM
            data += struct.pack('<d', value)
            data += struct.pack('<I', count)
            f.write(data)

if __name__ == '__main__':
    generate_sample_states()
    print("Generated sample_states.bin with incorrect format (includes padding)")