import numpy as np
import os

# Create the data directory if it doesn't exist
os.makedirs('/workspace/data', exist_ok=True)

# Set random seed for reproducibility
np.random.seed(42)

# Generate 10000 one-hot encoded labels with 10 classes
num_samples = 10000
num_classes = 10

# Create balanced distribution of classes
labels = np.zeros((num_samples, num_classes), dtype=np.float32)

# Assign each sample to a class (balanced distribution)
class_indices = np.random.randint(0, num_classes, size=num_samples)

# Convert to one-hot encoding
for i in range(num_samples):
    labels[i, class_indices[i]] = 1.0

# Save the labels array
np.save('/workspace/data/labels.npy', labels)

print(f"Generated labels array with shape: {labels.shape}")
print(f"Class distribution: {np.sum(labels, axis=0)}")