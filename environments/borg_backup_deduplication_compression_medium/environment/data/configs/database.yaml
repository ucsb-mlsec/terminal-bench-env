# Database Configuration File
# This file contains all database connection settings for different environments
# Total configuration size is optimized for testing compression efficiency

# ============================================================================
# PRODUCTION ENVIRONMENT DATABASE CONFIGURATION
# ============================================================================

production:
  # Primary database cluster configuration
  primary_database:
    host: prod-db-primary-01.example.com
    port: 5432
    database_name: production_app_db
    username: prod_app_user
    password: PLACEHOLDER_PROD_PASSWORD_HERE
    # Connection pool settings for optimal resource utilization
    connection_pool:
      min_connections: 5
      max_connections: 50
      connection_timeout: 30
      idle_timeout: 60
      max_lifetime: 1800
      validation_timeout: 5
    # SSL/TLS configuration for secure connections
    ssl:
      enabled: true
      mode: require
      cert_path: /etc/ssl/certs/prod-db-client.crt
      key_path: /etc/ssl/private/prod-db-client.key
      ca_cert_path: /etc/ssl/certs/prod-db-ca.crt
    # Query timeout settings
    timeouts:
      query_timeout: 60
      connection_timeout: 30
      keepalive_timeout: 120
    # Retry policy for failed connections
    retry_policy:
      max_retries: 3
      retry_interval: 5
      exponential_backoff: true
      max_retry_delay: 30

  # Read replica configuration for load balancing
  read_replicas:
    replica_01:
      host: prod-db-replica-01.example.com
      port: 5432
      database_name: production_app_db
      username: prod_app_user
      password: PLACEHOLDER_PROD_PASSWORD_HERE
      connection_pool:
        min_connections: 5
        max_connections: 50
        connection_timeout: 30
        idle_timeout: 60
        max_lifetime: 1800
        validation_timeout: 5
      ssl:
        enabled: true
        mode: require
        cert_path: /etc/ssl/certs/prod-db-client.crt
        key_path: /etc/ssl/private/prod-db-client.key
        ca_cert_path: /etc/ssl/certs/prod-db-ca.crt
      timeouts:
        query_timeout: 60
        connection_timeout: 30
        keepalive_timeout: 120
      retry_policy:
        max_retries: 3
        retry_interval: 5
        exponential_backoff: true
        max_retry_delay: 30

    replica_02:
      host: prod-db-replica-02.example.com
      port: 5432
      database_name: production_app_db
      username: prod_app_user
      password: PLACEHOLDER_PROD_PASSWORD_HERE
      connection_pool:
        min_connections: 5
        max_connections: 50
        connection_timeout: 30
        idle_timeout: 60
        max_lifetime: 1800
        validation_timeout: 5
      ssl:
        enabled: true
        mode: require
        cert_path: /etc/ssl/certs/prod-db-client.crt
        key_path: /etc/ssl/private/prod-db-client.key
        ca_cert_path: /etc/ssl/certs/prod-db-ca.crt
      timeouts:
        query_timeout: 60
        connection_timeout: 30
        keepalive_timeout: 120
      retry_policy:
        max_retries: 3
        retry_interval: 5
        exponential_backoff: true
        max_retry_delay: 30

  # Backup database configuration
  backup:
    enabled: true
    schedule: "0 2 * * *"
    retention_days: 30
    backup_location: /var/backups/database/production
    compression: true
    encryption: true
    parallel_workers: 4

  # Monitoring and alerting configuration
  monitoring:
    enabled: true
    metrics_port: 9090
    health_check_interval: 30
    slow_query_threshold: 5000
    connection_pool_alert_threshold: 45
    disk_space_alert_threshold: 85

# ============================================================================
# STAGING ENVIRONMENT DATABASE CONFIGURATION
# ============================================================================

staging:
  # Primary database cluster configuration
  primary_database:
    host: staging-db-primary-01.example.com
    port: 5432
    database_name: staging_app_db
    username: staging_app_user
    password: PLACEHOLDER_STAGING_PASSWORD_HERE
    # Connection pool settings for optimal resource utilization
    connection_pool:
      min_connections: 5
      max_connections: 50
      connection_timeout: 30
      idle_timeout: 60
      max_lifetime: 1800
      validation_timeout: 5
    # SSL/TLS configuration for secure connections
    ssl:
      enabled: true
      mode: require
      cert_path: /etc/ssl/certs/staging-db-client.crt
      key_path: /etc/ssl/private/staging-db-client.key
      ca_cert_path: /etc/ssl/certs/staging-db-ca.crt
    # Query timeout settings
    timeouts:
      query_timeout: 60
      connection_timeout: 30
      keepalive_timeout: 120
    # Retry policy for failed connections
    retry_policy:
      max_retries: 3
      retry_interval: 5
      exponential_backoff: true
      max_retry_delay: 30

  # Read replica configuration for load balancing
  read_replicas:
    replica_01:
      host: staging-db-replica-01.example.com
      port: 5432
      database_name: staging_app_db
      username: staging_app_user
      password: PLACEHOLDER_STAGING_PASSWORD_HERE
      connection_pool:
        min_connections: 5
        max_connections: 50
        connection_timeout: 30
        idle_timeout: 60
        max_lifetime: 1800
        validation_timeout: 5
      ssl:
        enabled: true
        mode: require
        cert_path: /etc/ssl/certs/staging-db-client.crt
        key_path: /etc/ssl/private/staging-db-client.key
        ca_cert_path: /etc/ssl/certs/staging-db-ca.crt
      timeouts:
        query_timeout: 60
        connection_timeout: 30
        keepalive_timeout: 120
      retry_policy:
        max_retries: 3
        retry_interval: 5
        exponential_backoff: true
        max_retry_delay: 30

  # Backup database configuration
  backup:
    enabled: true
    schedule: "0 3 * * *"
    retention_days: 14
    backup_location: /var/backups/database/staging
    compression: true
    encryption: true
    parallel_workers: 2

  # Monitoring and alerting configuration
  monitoring:
    enabled: true
    metrics_port: 9090
    health_check_interval: 30
    slow_query_threshold: 5000
    connection_pool_alert_threshold: 45
    disk_space_alert_threshold: 85

# ============================================================================
# DEVELOPMENT ENVIRONMENT DATABASE CONFIGURATION
# ============================================================================

development:
  # Primary database cluster configuration
  primary_database:
    host: dev-db-primary-01.example.com
    port: 5432
    database_name: development_app_db
    username: dev_app_user
    password: PLACEHOLDER_DEV_PASSWORD_HERE
    # Connection pool settings for optimal resource utilization
    connection_pool:
      min_connections: 5
      max_connections: 50
      connection_timeout: 30
      idle_timeout: 60
      max_lifetime: 1800
      validation_timeout: 5
    # SSL/TLS configuration for secure connections
    ssl:
      enabled: false
      mode: disable
      cert_path: /etc/ssl/certs/dev-db-client.crt
      key_path: /etc/ssl/private/dev-db-client.key
      ca_cert_path: /etc/ssl/certs/dev-db-ca.crt
    # Query timeout settings
    timeouts:
      query_timeout: 60
      connection_timeout: 30
      keepalive_timeout: 120
    # Retry policy for failed connections
    retry_policy:
      max_retries: 3
      retry_interval: 5
      exponential_backoff: true
      max_retry_delay: 30

  # Backup database configuration
  backup:
    enabled: false
    schedule: "0 4 * * *"
    retention_days: 7
    backup_location: /var/backups/database/development
    compression: true
    encryption: false
    parallel_workers: 1

  # Monitoring and alerting configuration
  monitoring:
    enabled: true
    metrics_port: 9090
    health_check_interval: 30
    slow_query_threshold: 5000
    connection_pool_alert_threshold: 45
    disk_space_alert_threshold: 85

# ============================================================================
# ANALYTICS DATABASE CONFIGURATION
# ============================================================================

analytics:
  # Primary analytics database configuration
  primary_database:
    host: analytics-db-primary-01.example.com
    port: 5432
    database_name: analytics_db
    username: analytics_user
    password: PLACEHOLDER_ANALYTICS_PASSWORD_HERE
    # Connection pool settings for optimal resource utilization
    connection_pool:
      min_connections: 5
      max_connections: 50
      connection_timeout: 30
      idle_timeout: 60
      max_lifetime: 1800
      validation_timeout: 5
    # SSL/TLS configuration for secure connections
    ssl:
      enabled: true
      mode: require
      cert_path: /etc/ssl/certs/analytics-db-client.crt
      key_path: /etc/ssl/private/analytics-db-client.key
      ca_cert_path: /etc/ssl/certs/analytics-db-ca.crt
    # Query timeout settings for long-running analytics queries
    timeouts:
      query_timeout: 300
      connection_timeout: 30
      keepalive_timeout: 120
    # Retry policy for failed connections
    retry_policy:
      max_retries: 3
      retry_interval: 5
      exponential_backoff: true
      max_retry_delay: 30

  # Read replica configuration for analytics workload distribution
  read_replicas:
    replica_01:
      host: analytics-db-replica-01.example.com
      port: 5432
      database_name: analytics_db
      username: analytics_user
      password: PLACEHOLDER_ANALYTICS_PASSWORD_HERE
      connection_pool:
        min_connections: 5
        max_connections: 50
        connection_timeout: 30
        idle_timeout: 60
        max_lifetime: 1800
        validation_timeout: 5
      ssl:
        enabled: true
        mode: require
        cert_path: /etc/ssl/certs/analytics-db-client.crt
        key_path: /etc/ssl/private/analytics-db-client.key
        ca_cert_path: /etc/ssl/certs/analytics-db-ca.crt
      timeouts:
        query_timeout: 300
        connection_timeout: 30
        keepalive_timeout: 120
      retry_policy:
        max_retries: 3
        retry_interval: 5
        exponential_backoff: true
        max_retry_delay: 30

    replica_02:
      host: analytics-db-replica-02.example.com
      port: 5432
      database_name: analytics_db
      username: analytics_user
      password: PLACEHOLDER_ANALYTICS_PASSWORD_HERE
      connection_pool:
        min_connections: 5
        max_connections: 50
        connection_timeout: 30
        idle_timeout: 60
        max_lifetime: 1800
        validation_timeout: 5
      ssl:
        enabled: true
        mode: require
        cert_path: /etc/ssl/certs/analytics-db-client.crt
        key_path: /etc/ssl/private/analytics-db-client.key
        ca_cert_path: /etc/ssl/certs/analytics-db-ca.crt
      timeouts:
        query_timeout: 300
        connection_timeout: 30
        keepalive_timeout: 120
      retry_policy:
        max_retries: 3
        retry_interval: 5
        exponential_backoff: true
        max_retry_delay: 30

    replica_03:
      host: analytics-db-replica-03.example.com
      port: 5432
      database_name: analytics_db
      username: analytics_user
      password: PLACEHOLDER_ANALYTICS_PASSWORD_HERE
      connection_pool:
        min_connections: 5
        max_connections: 50
        connection_timeout: 30
        idle_timeout: 60
        max_lifetime: 1800
        validation_timeout: 5
      ssl:
        enabled: true
        mode: require
        cert_path: /etc/ssl/certs/analytics-db-client.crt
        key_path: /etc/ssl/private/analytics-db-client.key
        ca_cert_path: /etc/ssl/certs/analytics-db-ca.crt
      timeouts:
        query_timeout: 300
        connection_timeout: 30
        keepalive_timeout: 120
      retry_policy:
        max_retries: 3
        retry_interval: 5
        exponential_backoff: true
        max_retry_delay: 30

  # Backup database configuration
  backup:
    enabled: true
    schedule: "0 1 * * *"
    retention_days: 90
    backup_location: /var/backups/database/analytics
    compression: true
    encryption: true
    parallel_workers: 8

  # Monitoring and alerting configuration
  monitoring:
    enabled: true
    metrics_port: 9090
    health_check_interval: 30
    slow_query_threshold: 10000
    connection_pool_alert_threshold: 45
    disk_space_alert_threshold: 85

# ============================================================================
# SHARED CONFIGURATION SETTINGS
# ============================================================================

shared_settings:
  # Global connection defaults
  connection_defaults:
    charset: utf8mb4
    timezone: UTC
    application_name: app_service
    statement_timeout: 30000
    lock_timeout: 10000
    idle_in_transaction_session_timeout: 60000

  # Connection pool defaults across all environments
  pool_defaults:
    min_connections: 5
    max_connections: 50
    connection_timeout: 30
    idle_timeout: 60
    max_lifetime: 1800
    validation_timeout: 5
    validation_query: "SELECT 1"

  # SSL certificate paths for different environments
  ssl_certificates:
    production:
      cert_path: /etc/ssl/certs/prod-db-client.crt
      key_path: /etc/ssl/private/prod-db-client.key
      ca_cert_path: /etc/ssl/certs/prod-db-ca.crt
    staging:
      cert_path: /etc/ssl/certs/staging-db-client.crt
      key_path: /etc/ssl/private/staging-db-client.key
      ca_cert_path: /etc/ssl/certs/staging-db-ca.crt
    development:
      cert_path: /etc/ssl/certs/dev-db-client.crt
      key_path: /etc/ssl/private/dev-db-client.key
      ca_cert_path: /etc/ssl/certs/dev-db-ca.crt
    analytics:
      cert_path: /etc/ssl/certs/analytics-db-client.crt
      key_path: /etc/ssl/private/analytics-db-client.key
      ca_cert_path: /etc/ssl/certs/analytics-db-ca.crt

  # Retry policies for all environments
  retry_policies:
    standard:
      max_retries: 3
      retry_interval: 5
      exponential_backoff: true
      max_retry_delay: 30
    aggressive:
      max_retries: 5
      retry_interval: 3
      exponential_backoff: true
      max_retry_delay: 60
    minimal:
      max_retries: 1
      retry_interval: 10
      exponential_backoff: false
      max_retry_delay: 10

  # Timeout configurations for different query types
  timeout_profiles:
    fast_queries:
      query_timeout: 30
      connection_timeout: 10
      keepalive_timeout: 60
    standard_queries:
      query_timeout: 60
      connection_timeout: 30
      keepalive_timeout: 120
    long_queries:
      query_timeout: 300
      connection_timeout: 30
      keepalive_timeout: 180
    batch_operations:
      query_timeout: 600
      connection_timeout: 60
      keepalive_timeout: 300

  # Monitoring thresholds for alerting
  monitoring_thresholds:
    critical:
      connection_pool_usage: 90
      query_duration: 10000
      disk_space_usage: 95
      replication_lag: 300
    warning:
      connection_pool_usage: 75
      query_duration: 5000
      disk_space_usage: 85
      replication_lag: 120
    info:
      connection_pool_usage: 50
      query_duration: 1000
      disk_space_usage: 70
      replication_lag: 60