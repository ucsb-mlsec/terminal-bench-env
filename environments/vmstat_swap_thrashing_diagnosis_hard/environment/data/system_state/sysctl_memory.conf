# Memory Management Parameters
# This file contains kernel memory and swap parameters

# vm.swappiness: Controls the tendency of the kernel to swap memory pages
# Range: 0-100. Higher values increase swap usage.
# Default: 60 (too high for database workloads, should be 1-10)
vm.swappiness = 60

# vm.dirty_ratio: Percentage of system memory that can be filled with dirty pages
# before processes are forced to write dirty buffers themselves during their time slice
vm.dirty_ratio = 20

# vm.dirty_background_ratio: Percentage of system memory that can be filled with
# dirty pages before the background kernel flusher threads begin to write them
vm.dirty_background_ratio = 10

# vm.dirty_expire_centisecs: How long data can be in cache before it needs to be written
# Value in hundredths of a second (3000 = 30 seconds)
vm.dirty_expire_centisecs = 3000

# vm.dirty_writeback_centisecs: How often the kernel wakes up to write data to disk
# Value in hundredths of a second (500 = 5 seconds)
vm.dirty_writeback_centisecs = 500

# vm.overcommit_memory: Controls memory overcommit behavior
# 0 = heuristic overcommit (default, risky for databases)
# 1 = always overcommit
# 2 = don't overcommit (recommended for databases)
vm.overcommit_memory = 0

# vm.overcommit_ratio: Percentage of physical RAM considered when overcommit_memory = 2
# Only applies when overcommit_memory is set to 2
vm.overcommit_ratio = 50

# vm.min_free_kbytes: Minimum number of kilobytes to keep free
# Forces the VM to keep a minimum number of kilobytes free
# This affects when the system starts swapping
vm.min_free_kbytes = 67584

# vm.vfs_cache_pressure: Controls the tendency to reclaim memory used for caching
# 100 is default, lower values preserve cache, higher values reclaim more aggressively
vm.vfs_cache_pressure = 100

# vm.zone_reclaim_mode: Controls whether memory reclaim happens locally or globally
# 0 = disabled (allocate from other zones before reclaiming)
vm.zone_reclaim_mode = 0

# vm.page-cluster: Controls the number of pages that are read in a single swap-in operation
# Higher values read more pages at once during swap-in
vm.page-cluster = 3

# kernel.shmmax: Maximum size of a single shared memory segment in bytes
# Important for database shared memory (68719476736 bytes = 64 GB)
kernel.shmmax = 68719476736

# kernel.shmall: Total amount of shared memory available in pages
# Total pages available for shared memory segments
kernel.shmall = 4294967296

# kernel.shmmni: Maximum number of shared memory segments system-wide
kernel.shmmni = 4096