# Redis configuration file

# GENERAL
port 6379
bind 127.0.0.1
protected-mode yes
daemonize yes
pidfile /var/run/redis.pid
loglevel notice
logfile /var/log/redis/redis.log
databases 16

# WORKING DIRECTORY
# The working directory where Redis will write the AOF file and RDB snapshots.
# WARNING: This directory must be writable by the Redis process.
dir /mnt/readonly-volume/redis

# SNAPSHOTTING
# Save the DB on disk periodically
save 900 1
save 300 10
save 60 10000
stop-writes-on-bgsave-error yes
rdbcompression yes
rdbchecksum yes
dbfilename dump.rdb

# MEMORY MANAGEMENT
maxmemory 2gb
maxmemory-policy allkeys-lru

# APPEND ONLY MODE
# By default Redis asynchronously dumps the dataset on disk. This mode can be
# good enough in many applications, but an issue with the Redis process or
# a power outage may result in a few minutes of writes lost.
#
# The Append Only File is an alternative persistence mode that provides
# much better durability.
appendonly yes

# The name of the append only file (default: "appendonly.aof")
appendfilename "appendonly.aof"

# The fsync() call tells the Operating System to actually write data on disk
# instead of waiting for more data in the output buffer.
#
# Redis supports three different modes:
#
# no: don't fsync, just let the OS flush the data when it wants. Faster.
# always: fsync after every write to the append only log. Slow, Safest.
# everysec: fsync only one time every second. Compromise.
appendfsync everysec

# When the AOF fsync policy is set to always or everysec, and a background
# saving process (a background save or AOF log background rewriting) is
# performing a lot of I/O against the disk, in some Linux configurations
# Redis may block too long on the fsync() call.
#
# If you have latency problems turn this to "yes". Otherwise leave it as
# "no" that is the safest pick from the point of view of durability.
no-appendfsync-on-rewrite yes

# Automatic rewrite of the append only file.
# Redis is able to automatically rewrite the log file implicitly calling
# BGREWRITEAOF when the AOF log size grows by the specified percentage.
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb

# An AOF file may be found to be truncated at the end during the Redis
# startup process, when the AOF data gets loaded back into memory.
# This may happen when the system where Redis is running crashes.
aof-load-truncated yes

# When rewriting the AOF file, Redis is able to use an RDB preamble in the
# AOF file for faster rewrites and recoveries.
aof-use-rdb-preamble yes

# SLOW LOG
# The Redis Slow Log is a system to log queries that exceeded a specified
# execution time.
slowlog-log-slower-than 10000
slowlog-max-len 128

# CLIENTS
# Set the max number of connected clients at the same time.
# maxclients 10000

# SECURITY
# requirepass foobared