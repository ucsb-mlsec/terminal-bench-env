2024-01-15 14:23:47.832 UTC [12456] ERROR:  deadlock detected
2024-01-15 14:23:47.832 UTC [12456] DETAIL:  Process 12456 waits for ShareLock on transaction 98765; blocked by process 12457.
	Process 12457 waits for ShareLock on transaction 98764; blocked by process 12456.
2024-01-15 14:23:47.832 UTC [12456] HINT:  See server log for query details.
2024-01-15 14:23:47.832 UTC [12456] CONTEXT:  while updating tuple (0,42) in relation "inventory"
2024-01-15 14:23:47.832 UTC [12456] STATEMENT:  UPDATE inventory SET quantity = quantity - 5 WHERE product_id = 101
2024-01-15 14:23:47.832 UTC [12456] LOG:  DEADLOCK DETECTED
2024-01-15 14:23:47.832 UTC [12456] DETAIL:  
	Process 12456:
	  Transaction ID: 98764
	  SQL: UPDATE inventory SET quantity = quantity - 5 WHERE product_id = 101
	  LOCK HELD: ExclusiveLock on tuple (0,15) of relation 16385 (orders)
	  LOCK WAITING: ShareLock on transaction 98765 for tuple (0,42) of relation 16386 (inventory)
	
	Process 12457:
	  Transaction ID: 98765
	  SQL: UPDATE orders SET status = 'processing' WHERE order_id = 2001
	  LOCK HELD: ExclusiveLock on tuple (0,42) of relation 16386 (inventory)
	  LOCK WAITING: ShareLock on transaction 98764 for tuple (0,15) of relation 16385 (orders)
	
	Process 12456 holds lock on relation orders, tuple (0,15)
	Process 12456 waits for lock on relation inventory, tuple (0,42)
	Process 12457 holds lock on relation inventory, tuple (0,42)
	Process 12457 waits for lock on relation orders, tuple (0,15)
	
	Deadlock cycle:
	  Process 12456 -> Process 12457 -> Process 12456
	
2024-01-15 14:23:47.832 UTC [12456] STATEMENT:  UPDATE inventory SET quantity = quantity - 5 WHERE product_id = 101
2024-01-15 14:23:47.833 UTC [12456] ERROR:  deadlock detected
2024-01-15 14:23:47.833 UTC [12456] DETAIL:  Process 12456 has been chosen as deadlock victim
2024-01-15 14:23:47.833 UTC [12456] HINT:  In a moment you should be able to reconnect to the database and repeat your command.
2024-01-15 14:23:47.833 UTC [12456] CONTEXT:  SQL statement "UPDATE inventory SET quantity = quantity - $1 WHERE product_id = $2"