<source>
  @type tail
  path /var/log/app/*.log
  pos_file /var/fluentd/pos/app.log.pos
  tag app.logs
  <parse>
    @type json
  </parse>
  read_from_head true
  refresh_interval 5s
</source>

<match **>
  @type file
  path /var/log/output/app.log
  append true
  <buffer>
    @type file
    path /var/fluentd/buffer/
    flush_mode interval
    flush_interval 10s
    chunk_limit_size 256k
    queue_limit_length 16
    total_limit_size 8m
    overflow_action throw_exception
    retry_type exponential_backoff
    retry_wait 10s
    retry_max_interval 300s
    retry_timeout 72h
  </buffer>
  <format>
    @type json
  </format>
</match>