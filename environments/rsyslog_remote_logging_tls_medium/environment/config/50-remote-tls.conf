# Incomplete TLS configuration - DO NOT USE IN PRODUCTION
# Started by previous admin - needs fixes before deployment

# Load network output module
module(load="omfwd")

# TLS driver configuration - INCOMPLETE
$DefaultNetstreamDriver gtsl
$DefaultNetstreamDriverCAFile /etc/pki/tls/cert/ca-bundle.crt
$DefaultNetstreamDriverCertFile /etc/pki/tls/certs/server-cert.pem
$ActionSendStreamDriverMode 0
$ActionSendStreamDriverAuthMode anon

# Queue configuration for remote forwarding
$ActionQueueType LinkedList
$ActionQueueFileName remote_queue
$ActionResumeRetryCount -1
$ActionQueueSaveOnShutdown on

# Forward authentication logs to central server
authpriv.* @@logs.company.internal:6514

# Alternative syntax attempt - choose one
action(type="omfwd" target="logs.company.internal" port="6514" protocol="tcp"
       StreamDriver="gtls" StreamDriverMode="1"
       StreamDriverAuthMode="x509/name"