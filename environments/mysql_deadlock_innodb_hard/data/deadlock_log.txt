========================
LATEST DETECTED DEADLOCK
========================
2024-01-15 14:23:45 0x7f8b2c004700
*** (1) TRANSACTION:
TRANSACTION 421567823945, ACTIVE 0.003 sec starting index read
mysql tables in use 1, locked 1
LOCK WAIT 3 lock struct(s), heap size 1136, 2 row lock(s), undo log entries 1
MySQL thread id 12847, OS thread handle 140238563104512, query id 98234567 localhost appuser updating
UPDATE inventory SET quantity_available = quantity_available - 5 WHERE product_id = 101
*** (1) WAITING FOR THIS LOCK TO BE GRANTED:
RECORD LOCKS space id 245 page no 487 n bits 248 index PRIMARY of table `production_db`.`inventory` trx id 421567823945 lock_mode X locks rec but not gap waiting
Record lock, heap no 67 PHYSICAL RECORD: n_fields 6; compact format; info bits 0
 0: len 4; hex 80000065; asc    e;;
 1: len 6; hex 000064a3b2f9; asc   d   ;;
 2: len 7; hex 81000001c50110; asc        ;;
 3: len 4; hex 80000065; asc    e;;
 4: len 4; hex 800001f4; asc     ;;
 5: len 8; hex 8000000000000064; asc        d;;

*** (1) HOLDS THE LOCK(S):
RECORD LOCKS space id 242 page no 156 n bits 312 index PRIMARY of table `production_db`.`order_items` trx id 421567823945 lock_mode X locks rec but not gap
Record lock, heap no 145 PHYSICAL RECORD: n_fields 8; compact format; info bits 0
 0: len 4; hex 80003a51; asc   :Q;;
 1: len 6; hex 000064a3b2f9; asc   d   ;;
 2: len 7; hex 81000001c50110; asc        ;;
 3: len 4; hex 80003a4e; asc   :N;;
 4: len 4; hex 80000065; asc    e;;
 5: len 4; hex 80000005; asc     ;;
 6: len 8; hex 8000000000000c1c; asc        ;;
 7: len 8; hex 8000000000000fa0; asc        ;;

*** (2) TRANSACTION:
TRANSACTION 421567823946, ACTIVE 0.002 sec starting index read
mysql tables in use 1, locked 1
LOCK WAIT 4 lock struct(s), heap size 1136, 3 row lock(s), undo log entries 2
MySQL thread id 12851, OS thread handle 140238562838272, query id 98234571 localhost appuser updating
UPDATE order_items SET status = 'reserved', reserved_at = NOW() WHERE order_item_id = 14929
*** (2) WAITING FOR THIS LOCK TO BE GRANTED:
RECORD LOCKS space id 242 page no 156 n bits 312 index PRIMARY of table `production_db`.`order_items` trx id 421567823946 lock_mode X locks rec but not gap waiting
Record lock, heap no 145 PHYSICAL RECORD: n_fields 8; compact format; info bits 0
 0: len 4; hex 80003a51; asc   :Q;;
 1: len 6; hex 000064a3b2f9; asc   d   ;;
 2: len 7; hex 81000001c50110; asc        ;;
 3: len 4; hex 80003a4e; asc   :N;;
 4: len 4; hex 80000065; asc    e;;
 5: len 4; hex 80000005; asc     ;;
 6: len 8; hex 8000000000000c1c; asc        ;;
 7: len 8; hex 8000000000000fa0; asc        ;;

*** (2) HOLDS THE LOCK(S):
RECORD LOCKS space id 245 page no 487 n bits 248 index PRIMARY of table `production_db`.`inventory` trx id 421567823946 lock_mode X locks rec but not gap
Record lock, heap no 67 PHYSICAL RECORD: n_fields 6; compact format; info bits 0
 0: len 4; hex 80000065; asc    e;;
 1: len 6; hex 000064a3b2f9; asc   d   ;;
 2: len 7; hex 81000001c50110; asc        ;;
 3: len 4; hex 80000065; asc    e;;
 4: len 4; hex 800001f4; asc     ;;
 5: len 8; hex 8000000000000064; asc        d;;

*** WE ROLL BACK TRANSACTION (2)