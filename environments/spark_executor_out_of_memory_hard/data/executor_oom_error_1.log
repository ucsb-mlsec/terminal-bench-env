2024-01-15 14:23:45 ERROR Executor: Exception in task 127.0 in stage 3.0 (TID 1543)
2024-01-15 14:23:45 ERROR Executor: Executor ID: 5, Host: worker-node-03
2024-01-15 14:23:45 INFO MemoryStore: Memory usage: 7.8GB / 8.0GB (97.5% full)
2024-01-15 14:23:45 WARN TaskMemoryManager: Failed to allocate additional memory for shuffle buffer
2024-01-15 14:23:45 ERROR Executor: Task attempt failed - OutOfMemoryError during shuffle
java.lang.OutOfMemoryError: Java heap space
	at java.util.Arrays.copyOf(Arrays.java:3332)
	at java.io.ByteArrayOutputStream.grow(ByteArrayOutputStream.java:118)
	at java.io.ByteArrayOutputStream.ensureCapacity(ByteArrayOutputStream.java:93)
	at org.apache.spark.util.collection.ExternalAppendOnlyMap.insertAll(ExternalAppendOnlyMap.scala:154)
	at org.apache.spark.shuffle.sort.UnsafeShuffleWriter.write(UnsafeShuffleWriter.java:187)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)
	at org.apache.spark.scheduler.Task.run(Task.scala:123)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:449)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
2024-01-15 14:23:45 ERROR TaskSetManager: Task 127 in stage 3.0 failed 4 times; aborting job
2024-01-15 14:23:45 INFO ShuffleBlockFetcherIterator: Getting 243 non-empty blocks including 0 local blocks and 243 remote blocks
2024-01-15 14:23:45 ERROR Stage: Stage 3 (groupBy at transaction_aggregator.py:87) failed
2024-01-15 14:23:46 WARN MemoryManager: Execution memory pool exhausted
2024-01-15 14:23:46 INFO ExecutorMetrics: Heap memory used: 8388608000 bytes (8.0GB)
2024-01-15 14:23:46 INFO ExecutorMetrics: Off-heap memory used: 524288000 bytes (500MB)
2024-01-15 14:23:46 WARN GarbageCollectionMetrics: Total GC time in last minute: 15234 ms (15.2s)
2024-01-15 14:23:46 WARN GarbageCollectionMetrics: GC time exceeded 10% of task time
2024-01-15 14:23:46 ERROR ShuffleWriter: Failed to write shuffle output for partition 127
2024-01-15 14:23:46 INFO TaskMemoryManager: Memory acquired by task: 7956423680 bytes
2024-01-15 14:23:46 INFO TaskMemoryManager: Memory spill threshold: 6710886400 bytes
2024-01-15 14:23:46 WARN UnsafeShuffleWriter: Unable to spill in-memory map to disk
2024-01-15 14:23:46 ERROR Executor: Exception in shuffle operation during join at transaction_aggregator.py:72
2024-01-15 14:23:46 INFO ShuffleMapTask: Shuffle map task in stage 3.0, partition 127
2024-01-15 14:23:46 INFO ShuffleMapTask: Processing records from upstream stage shuffle read
2024-01-15 14:23:46 ERROR Utils: Aborting task
java.lang.OutOfMemoryError: Java heap space
	at org.apache.spark.util.collection.ExternalSorter.insertAll(ExternalSorter.scala:197)
	at org.apache.spark.shuffle.sort.SortShuffleWriter.write(SortShuffleWriter.scala:63)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)
2024-01-15 14:23:46 WARN BlockManager: Failed to remove shuffle block shuffle_3_127_0
2024-01-15 14:23:46 ERROR TaskRunner: Task 127.3 in stage 3.0 (TID 1543) failed
2024-01-15 14:23:46 INFO Executor: Finished task 127.3 in stage 3.0 (TID 1543). Result SerializationTime: 0ms, ExecutorRunTime: 127345ms, GC Time: 15234ms
2024-01-15 14:23:46 INFO DiskBlockManager: Failed to create local directory for shuffle blocks
2024-01-15 14:23:47 ERROR BlockManagerMaster: Block shuffle_3_127_0 not found on any worker
2024-01-15 14:23:47 WARN TaskSetManager: Lost task 127.3 in stage 3.0 (TID 1543) on worker-node-03, executor 5: java.lang.OutOfMemoryError (Java heap space)
2024-01-15 14:23:47 INFO DAGScheduler: ShuffleMapStage 3 (groupBy at transaction_aggregator.py:87) failed in 127.4 s due to Stage failed because task 127 failed
2024-01-15 14:23:47 ERROR DAGScheduler: Job aborted due to stage failure: Task 127 in stage 3.0 failed 4 times, most recent failure: OutOfMemoryError
2024-01-15 14:23:47 INFO ContextCleaner: Cleaned shuffle 3
2024-01-15 14:23:47 WARN TaskSchedulerImpl: Initial job has not accepted any resources
2024-01-15 14:23:47 ERROR ApplicationMaster: User application exited with status 1
2024-01-15 14:23:47 INFO SparkContext: Successfully stopped SparkContext
2024-01-15 14:23:47 ERROR SparkContext: Error occurred during execution of transaction aggregation job
2024-01-15 14:23:47 INFO RemoteBlockManager: Removed broadcast_2_piece0 on worker-node-03:42157 in memory
2024-01-15 14:23:47 ERROR TransactionAggregator: Job failed during shuffle phase with OOM error
2024-01-15 14:23:47 INFO ShutdownHookManager: Shutdown hook called
2024-01-15 14:23:47 INFO ShutdownHookManager: Deleting directory /tmp/spark-7a3c9e2f-8b4d-4c1a-9f6e-2d8b5a7c4e9f