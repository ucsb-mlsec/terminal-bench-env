# PostgreSQL Standby Replica Configuration File
# Generated for streaming replication standby server
# Last modified: 2024-01-15

# CONNECTION SETTINGS
# Allow sufficient connections for read queries on hot standby
max_connections = 200

# MEMORY SETTINGS
# Shared memory buffer pool
shared_buffers = 2GB

# Query planner's assumption about effective cache
effective_cache_size = 6GB

# Memory used for each sort/hash operation
work_mem = 16MB

# Memory used for maintenance operations
maintenance_work_mem = 256MB

# HOT STANDBY SETTINGS
# Enable hot standby mode to allow read-only queries on replica
hot_standby = on

# Maximum delay before canceling queries when WAL data is about to be applied
# Lower value prioritizes replication over query completion
# Higher value allows long-running queries but may increase lag
max_standby_streaming_delay = 30s

# Maximum delay for archive recovery (similar to streaming delay)
max_standby_archive_delay = 30s

# Send feedback to primary about queries running on standby
# Helps prevent primary from removing WAL needed by standby queries
hot_standby_feedback = on

# REPLICATION SETTINGS
# Interval for WAL receiver to send status updates to primary
wal_receiver_status_interval = 10s

# CHECKPOINT SETTINGS
# Time between automatic WAL checkpoints
checkpoint_timeout = 5min

# LOGGING SETTINGS
log_destination = 'stderr'
logging_collector = on
log_directory = '/var/log/postgresql'
log_filename = 'postgresql-%Y-%m-%d.log'
log_line_prefix = '%t [%p]: [%l-1] user=%u,db=%d,app=%a,client=%h '
log_min_duration_statement = 1000
log_checkpoints = on
log_connections = on
log_disconnections = on
log_replication_commands = on

# WAL SETTINGS
wal_level = replica
max_wal_senders = 10
wal_keep_size = 1GB