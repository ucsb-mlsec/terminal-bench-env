<abi-descriptor version="1.3.0">
  <!-- Core initialization functions -->
  <function name="mw_init" return_type="int">
    <parameter name="config" type="mw_config_t*"/>
  </function>
  
  <function name="mw_shutdown" return_type="void"/>
  
  <function name="mw_get_version" return_type="const char*"/>
  
  <!-- Connection management -->
  <function name="mw_connect" return_type="mw_handle_t">
    <parameter name="host" type="const char*"/>
    <parameter name="port" type="int"/>
  </function>
  
  <function name="mw_disconnect" return_type="int">
    <parameter name="handle" type="mw_handle_t"/>
  </function>
  
  <function name="mw_reconnect" return_type="int">
    <parameter name="handle" type="mw_handle_t"/>
  </function>
  
  <!-- BREAKING CHANGE: mw_set_timeout signature changed - was (handle, timeout), now has additional parameter -->
  <function name="mw_set_timeout" return_type="int">
    <parameter name="handle" type="mw_handle_t"/>
    <parameter name="timeout_ms" type="int"/>
    <parameter name="timeout_type" type="int"/>
  </function>
  
  <!-- Data operations -->
  <function name="mw_send" return_type="int">
    <parameter name="handle" type="mw_handle_t"/>
    <parameter name="data" type="const void*"/>
    <parameter name="size" type="size_t"/>
  </function>
  
  <function name="mw_receive" return_type="int">
    <parameter name="handle" type="mw_handle_t"/>
    <parameter name="buffer" type="void*"/>
    <parameter name="size" type="size_t"/>
  </function>
  
  <function name="mw_send_async" return_type="int">
    <parameter name="handle" type="mw_handle_t"/>
    <parameter name="data" type="const void*"/>
    <parameter name="size" type="size_t"/>
    <parameter name="callback" type="mw_callback_t"/>
  </function>
  
  <function name="mw_receive_async" return_type="int">
    <parameter name="handle" type="mw_handle_t"/>
    <parameter name="buffer" type="void*"/>
    <parameter name="size" type="size_t"/>
    <parameter name="callback" type="mw_callback_t"/>
  </function>
  
  <!-- BREAKING CHANGE: mw_flush return type changed from void to int -->
  <function name="mw_flush" return_type="int">
    <parameter name="handle" type="mw_handle_t"/>
  </function>
  
  <!-- Buffer management -->
  <function name="mw_buffer_create" return_type="mw_buffer_t*">
    <parameter name="size" type="size_t"/>
  </function>
  
  <function name="mw_buffer_destroy" return_type="void">
    <parameter name="buffer" type="mw_buffer_t*"/>
  </function>
  
  <function name="mw_buffer_resize" return_type="int">
    <parameter name="buffer" type="mw_buffer_t*"/>
    <parameter name="new_size" type="size_t"/>
  </function>
  
  <function name="mw_buffer_clear" return_type="void">
    <parameter name="buffer" type="mw_buffer_t*"/>
  </function>
  
  <function name="mw_buffer_append" return_type="int">
    <parameter name="buffer" type="mw_buffer_t*"/>
    <parameter name="data" type="const void*"/>
    <parameter name="size" type="size_t"/>
  </function>
  
  <!-- Error handling -->
  <function name="mw_get_last_error" return_type="int"/>
  
  <function name="mw_error_string" return_type="const char*">
    <parameter name="error_code" type="int"/>
  </function>
  
  <function name="mw_clear_error" return_type="void"/>
  
  <!-- Configuration -->
  <function name="mw_set_option" return_type="int">
    <parameter name="handle" type="mw_handle_t"/>
    <parameter name="option" type="int"/>
    <parameter name="value" type="void*"/>
  </function>
  
  <function name="mw_get_option" return_type="int">
    <parameter name="handle" type="mw_handle_t"/>
    <parameter name="option" type="int"/>
    <parameter name="value" type="void*"/>
  </function>
  
  <!-- Statistics -->
  <function name="mw_get_stats" return_type="int">
    <parameter name="handle" type="mw_handle_t"/>
    <parameter name="stats" type="mw_stats_t*"/>
  </function>
  
  <function name="mw_reset_stats" return_type="void">
    <parameter name="handle" type="mw_handle_t"/>
  </function>
  
  <!-- Session management -->
  <function name="mw_session_create" return_type="mw_session_t*">
    <parameter name="handle" type="mw_handle_t"/>
  </function>
  
  <function name="mw_session_destroy" return_type="void">
    <parameter name="session" type="mw_session_t*"/>
  </function>
  
  <function name="mw_session_start" return_type="int">
    <parameter name="session" type="mw_session_t*"/>
  </function>
  
  <function name="mw_session_stop" return_type="int">
    <parameter name="session" type="mw_session_t*"/>
  </function>
  
  <!-- BREAKING CHANGE: mw_session_get_id function removed (not present in this version) -->
  
  <!-- Logging -->
  <function name="mw_log_set_level" return_type="void">
    <parameter name="level" type="int"/>
  </function>
  
  <function name="mw_log_get_level" return_type="int"/>
  
  <function name="mw_log_message" return_type="void">
    <parameter name="level" type="int"/>
    <parameter name="message" type="const char*"/>
  </function>
  
  <!-- Thread pool -->
  <function name="mw_threadpool_init" return_type="int">
    <parameter name="num_threads" type="int"/>
  </function>
  
  <function name="mw_threadpool_shutdown" return_type="void"/>
  
  <function name="mw_threadpool_submit" return_type="int">
    <parameter name="task" type="mw_task_t*"/>
  </function>
  
  <!-- Queue operations -->
  <function name="mw_queue_create" return_type="mw_queue_t*">
    <parameter name="capacity" type="size_t"/>
  </function>
  
  <function name="mw_queue_destroy" return_type="void">
    <parameter name="queue" type="mw_queue_t*"/>
  </function>
  
  <function name="mw_queue_push" return_type="int">
    <parameter name="queue" type="mw_queue_t*"/>
    <parameter name="item" type="void*"/>
  </function>
  
  <function name="mw_queue_pop" return_type="void*">
    <parameter name="queue" type="mw_queue_t*"/>
  </function>
  
  <function name="mw_queue_size" return_type="size_t">
    <parameter name="queue" type="mw_queue_t*"/>
  </function>
  
  <!-- NEW FUNCTION: Added in v1.3.0 -->
  <function name="mw_queue_peek" return_type="void*">
    <parameter name="queue" type="mw_queue_t*"/>
  </function>
  
  <!-- NEW FUNCTION: Added in v1.3.0 -->
  <function name="mw_queue_is_empty" return_type="int">
    <parameter name="queue" type="mw_queue_t*"/>
  </function>
  
  <!-- NEW FUNCTION: Added in v1.3.0 -->
  <function name="mw_set_debug_mode" return_type="void">
    <parameter name="enabled" type="int"/>
  </function>
  
  <!-- NEW FUNCTION: Added in v1.3.0 -->
  <function name="mw_get_build_info" return_type="const char*"/>
  
  <!-- NEW FUNCTION: Added in v1.3.0 -->
  <function name="mw_validate_config" return_type="int">
    <parameter name="config" type="const mw_config_t*"/>
  </function>
  
  <!-- Struct definitions -->
  <struct name="mw_config_t">
    <field name="version" type="int" offset="0"/>
    <field name="flags" type="unsigned int" offset="4"/>
    <field name="max_connections" type="int" offset="8"/>
    <field name="buffer_size" type="size_t" offset="12"/>
    <field name="timeout" type="int" offset="16"/>
  </struct>
  
  <!-- BREAKING CHANGE: mw_connection_info_t struct layout changed - fields reordered -->
  <struct name="mw_connection_info_t">
    <field name="state" type="int" offset="0"/>
    <field name="handle" type="mw_handle_t" offset="4"/>
    <field name="host" type="char*" offset="8"/>
    <field name="port" type="int" offset="12"/>
    <field name="connected_time" type="long" offset="16"/>
  </struct>
  
  <struct name="mw_stats_t">
    <field name="bytes_sent" type="unsigned long" offset="0"/>
    <field name="bytes_received" type="unsigned long" offset="8"/>
    <field name="packets_sent" type="unsigned long" offset="16"/>
    <field name="packets_received" type="unsigned long" offset="24"/>
    <field name="errors" type="unsigned int" offset="32"/>
  </struct>
  
  <struct name="mw_buffer_t">
    <field name="data" type="void*" offset="0"/>
    <field name="size" type="size_t" offset="4"/>
    <field name="capacity" type="size_t" offset="8"/>
    <field name="flags" type="unsigned int" offset="12"/>
  </struct>
  
  <!-- Typedefs -->
  <typedef name="mw_handle_t" base_type="int"/>
  <typedef name="mw_callback_t" base_type="void (*)(void*)"/>
  <typedef name="mw_session_t" base_type="struct mw_session"/>
  <typedef name="mw_task_t" base_type="struct mw_task"/>
  <typedef name="mw_queue_t" base_type="struct mw_queue"/>
</abi-descriptor>