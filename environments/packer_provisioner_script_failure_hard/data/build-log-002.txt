2024-01-15 09:23:47 [INFO] Packer build started
2024-01-15 09:23:47 [INFO] Packer version: 1.8.6
2024-01-15 09:23:47 [INFO] Reading template: ubuntu-server.pkr.hcl
2024-01-15 09:23:47 [INFO] Validating template configuration
2024-01-15 09:23:48 [INFO] Template validation successful

==> ubuntu-2204-base: Build 'ubuntu-2204-base' starting
==> ubuntu-2204-base: Initializing builder: virtualbox-iso
==> ubuntu-2204-base: Creating virtual machine...
==> ubuntu-2204-base: Configuring VM settings:
==> ubuntu-2204-base:   - Memory: 2048 MB
==> ubuntu-2204-base:   - CPUs: 2
==> ubuntu-2204-base:   - Disk size: 40960 MB
==> ubuntu-2204-base: Attaching ISO: ubuntu-22.04.1-live-server-amd64.iso
==> ubuntu-2204-base: Starting virtual machine...
==> ubuntu-2204-base: Waiting for SSH to become available...
==> ubuntu-2204-base: Connected to SSH!
==> ubuntu-2204-base: Provisioning with shell script: scripts/setup-base.sh

    ubuntu-2204-base: ========================================
    ubuntu-2204-base: Starting base system setup
    ubuntu-2204-base: ========================================
    ubuntu-2204-base: Checking system prerequisites...
    ubuntu-2204-base: System: Ubuntu 22.04.1 LTS
    ubuntu-2204-base: Kernel: 5.15.0-56-generic
    ubuntu-2204-base: 
    ubuntu-2204-base: Updating system clock...
    ubuntu-2204-base: System time synchronized: Mon Jan 15 09:24:35 UTC 2024
    ubuntu-2204-base: 
    ubuntu-2204-base: Creating required directories...
    ubuntu-2204-base: Created: /opt/app
    ubuntu-2204-base: Created: /opt/app/bin
    ubuntu-2204-base: Created: /opt/app/config
    ubuntu-2204-base: Created: /var/log/app
    ubuntu-2204-base: 
    ubuntu-2204-base: Setting directory permissions...
    ubuntu-2204-base: Permissions set for /opt/app
    ubuntu-2204-base: Permissions set for /var/log/app
    ubuntu-2204-base: 
    ubuntu-2204-base: Configuring environment variables...
    ubuntu-2204-base: Added PATH configuration to /etc/profile.d/app-env.sh
    ubuntu-2204-base: 
    ubuntu-2204-base: Base setup completed successfully
    ubuntu-2204-base: ========================================

==> ubuntu-2204-base: Provisioning with shell script: scripts/install-packages.sh

    ubuntu-2204-base: ========================================
    ubuntu-2204-base: Installing required packages
    ubuntu-2204-base: ========================================
    ubuntu-2204-base: 
    ubuntu-2204-base: Refreshing package lists...
    ubuntu-2204-base: Hit:1 http://archive.ubuntu.com/ubuntu jammy InRelease
    ubuntu-2204-base: Get:2 http://archive.ubuntu.com/ubuntu jammy-updates InRelease [119 kB]
    ubuntu-2204-base: Get:3 http://archive.ubuntu.com/ubuntu jammy-backports InRelease [107 kB]
    ubuntu-2204-base: Get:4 http://archive.ubuntu.com/ubuntu jammy-security InRelease [110 kB]
    ubuntu-2204-base: Get:5 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 Packages [892 kB]
    ubuntu-2204-base: Get:6 http://archive.ubuntu.com/ubuntu jammy-updates/universe amd64 Packages [456 kB]
    ubuntu-2204-base: Fetched 1,684 kB in 3s (561 kB/s)
    ubuntu-2204-base: Reading package lists...
    ubuntu-2204-base: 
    ubuntu-2204-base: Installing base utilities...
    ubuntu-2204-base: Reading package lists...
    ubuntu-2204-base: Building dependency tree...
    ubuntu-2204-base: Reading state information...
    ubuntu-2204-base: The following additional packages will be installed:
    ubuntu-2204-base:   libcurl4 libnghttp2-14 libpsl5 librtmp1 libssh-4
    ubuntu-2204-base: Suggested packages:
    ubuntu-2204-base:   curl-doc
    ubuntu-2204-base: The following NEW packages will be installed:
    ubuntu-2204-base:   curl git jq unzip wget
    ubuntu-2204-base: 0 upgraded, 5 newly installed, 0 to remove and 12 not upgraded.
    ubuntu-2204-base: Need to get 4,892 kB of archives.
    ubuntu-2204-base: After this operation, 22.1 MB of additional disk space will be used.
    ubuntu-2204-base: Get:1 http://archive.ubuntu.com/ubuntu jammy/main amd64 curl amd64 7.81.0-1ubuntu1.6 [194 kB]
    ubuntu-2204-base: Get:2 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 git amd64 1:2.34.1-1ubuntu1.8 [3,165 kB]
    ubuntu-2204-base: Get:3 http://archive.ubuntu.com/ubuntu jammy/main amd64 jq amd64 1.6-2.1ubuntu3 [52.1 kB]
    ubuntu-2204-base: Get:4 http://archive.ubuntu.com/ubuntu jammy/main amd64 unzip amd64 6.0-26ubuntu3.1 [174 kB]
    ubuntu-2204-base: Get:5 http://archive.ubuntu.com/ubuntu jammy/main amd64 wget amd64 1.21.2-2ubuntu1 [357 kB]
    ubuntu-2204-base: Fetched 4,892 kB in 2s (2,446 kB/s)
    ubuntu-2204-base: Selecting previously unselected package curl.
    ubuntu-2204-base: (Reading database ... 75642 files and directories currently installed.)
    ubuntu-2204-base: Preparing to unpack .../curl_7.81.0-1ubuntu1.6_amd64.deb ...
    ubuntu-2204-base: Unpacking curl (7.81.0-1ubuntu1.6) ...
    ubuntu-2204-base: Selecting previously unselected package git.
    ubuntu-2204-base: Preparing to unpack .../git_1%3a2.34.1-1ubuntu1.8_amd64.deb ...
    ubuntu-2204-base: Unpacking git (1:2.34.1-1ubuntu1.8) ...
    ubuntu-2204-base: Selecting previously unselected package jq.
    ubuntu-2204-base: Preparing to unpack .../jq_1.6-2.1ubuntu3_amd64.deb ...
    ubuntu-2204-base: Unpacking jq (1.6-2.1ubuntu3) ...
    ubuntu-2204-base: Selecting previously unselected package unzip.
    ubuntu-2204-base: Preparing to unpack .../unzip_6.0-26ubuntu3.1_amd64.deb ...
    ubuntu-2204-base: Unpacking unzip (6.0-26ubuntu3.1) ...
    ubuntu-2204-base: Selecting previously unselected package wget.
    ubuntu-2204-base: Preparing to unpack .../wget_1.21.2-2ubuntu1_amd64.deb ...
    ubuntu-2204-base: Unpacking wget (1.21.2-2ubuntu1) ...
    ubuntu-2204-base: Setting up curl (7.81.0-1ubuntu1.6) ...
    ubuntu-2204-base: Setting up wget (1.21.2-2ubuntu1) ...
    ubuntu-2204-base: Setting up unzip (6.0-26ubuntu3.1) ...
    ubuntu-2204-base: Setting up jq (1.6-2.1ubuntu3) ...
    ubuntu-2204-base: Setting up git (1:2.34.1-1ubuntu1.8) ...
    ubuntu-2204-base: 
    ubuntu-2204-base: Installing development tools...
    ubuntu-2204-base: Reading package lists...
    ubuntu-2204-base: Building dependency tree...
    ubuntu-2204-base: Reading state information...
    ubuntu-2204-base: The following additional packages will be installed:
    ubuntu-2204-base:   binutils binutils-common binutils-x86-64-linux-gnu build-essential cpp
    ubuntu-2204-base:   cpp-11 dpkg-dev g++ g++-11 gcc gcc-11 gcc-11-base libc6-dev libgcc-11-dev
    ubuntu-2204-base:   libstdc++-11-dev make
    ubuntu-2204-base: Suggested packages:
    ubuntu-2204-base:   binutils-doc cpp-doc gcc-11-locales debian-keyring gcc-doc
    ubuntu-2204-base: The following NEW packages will be installed:
    ubuntu-2204-base:   build-essential gcc g++ make
    ubuntu-2204-base: 0 upgraded, 4 newly installed, 0 to remove and 12 not upgraded.
    ubuntu-2204-base: Need to get 38.4 MB of archives.
    ubuntu-2204-base: After this operation, 156 MB of additional disk space will be used.
    ubuntu-2204-base: Get:1 http://archive.ubuntu.com/ubuntu jammy/main amd64 binutils-common amd64 2.38-3ubuntu1 [217 kB]
    ubuntu-2204-base: Get:2 http://archive.ubuntu.com/ubuntu jammy/main amd64 gcc-11-base amd64 11.3.0-1ubuntu1~22.04 [19.8 kB]
    ubuntu-2204-base: Get:3 http://archive.ubuntu.com/ubuntu jammy/main amd64 libc6-dev amd64 2.35-0ubuntu3.1 [2,098 kB]
    ubuntu-2204-base: debconf: unable to initialize frontend: Dialog
    ubuntu-2204-base: debconf: (Dialog frontend will not work on a dumb terminal, an emacs shell buffer, or without a controlling terminal.)
    ubuntu-2204-base: debconf: falling back to frontend: Readline
    ubuntu-2204-base: debconf: unable to initialize frontend: Readline
    ubuntu-2204-base: debconf: (This frontend requires a controlling tty.)
    ubuntu-2204-base: debconf: falling back to frontend: Teletype
    ubuntu-2204-base: dpkg-preconfigure: unable to re-open stdin:
    ubuntu-2204-base: Get:4 http://archive.ubuntu.com/ubuntu jammy/main amd64 gcc-11 amd64 11.3.0-1ubuntu1~22.04 [19.2 MB]
    ubuntu-2204-base: Get:5 http://archive.ubuntu.com/ubuntu jammy/main amd64 gcc amd64 4:11.2.0-1ubuntu1 [5,112 B]
    ubuntu-2204-base: Fetched 21.5 MB in 8s (2,688 kB/s)
    ubuntu-2204-base: Selecting previously unselected package binutils-common:amd64.
    ubuntu-2204-base: (Reading database ... 76234 files and directories currently installed.)
    ubuntu-2204-base: Preparing to unpack .../0-binutils-common_2.38-3ubuntu1_amd64.deb ...
    ubuntu-2204-base: Unpacking binutils-common:amd64 (2.38-3ubuntu1) ...
    ubuntu-2204-base: Selecting previously unselected package gcc-11-base:amd64.
    ubuntu-2204-base: Preparing to unpack .../1-gcc-11-base_11.3.0-1ubuntu1~22.04_amd64.deb ...
    ubuntu-2204-base: Unpacking gcc-11-base:amd64 (11.3.0-1ubuntu1~22.04) ...
    ubuntu-2204-base: Selecting previously unselected package libc6-dev:amd64.
    ubuntu-2204-base: Preparing to unpack .../2-libc6-dev_2.35-0ubuntu3.1_amd64.deb ...
    ubuntu-2204-base: Unpacking libc6-dev:amd64 (2.35-0ubuntu3.1) ...
    ubuntu-2204-base: dpkg: error processing archive /var/cache/apt/archives/libc6-dev_2.35-0ubuntu3.1_amd64.deb (--unpack):
    ubuntu-2204-base:  trying to overwrite '/usr/include/c++/11/stdlib.h', which is also in package libstdc++-11-dev:amd64 11.2.0-7ubuntu2
    ubuntu-2204-base: Errors were encountered while processing:
    ubuntu-2204-base:  /var/cache/apt/archives/libc6-dev_2.35-0ubuntu3.1_amd64.deb
    ubuntu-2204-base: E: Sub-process /usr/bin/dpkg returned an error code (1)
    ubuntu-2204-base: 
    ubuntu-2204-base: ERROR: Package installation failed with exit code 100
    ubuntu-2204-base: Package installation incomplete

==> ubuntu-2204-base: Provisioning step had errors: Running the cleanup provisioner, if present...
==> ubuntu-2204-base: Stopping virtual machine...
==> ubuntu-2204-base: Deleting output directory...
==> ubuntu-2204-base: Build 'ubuntu-2204-base' errored after 3 minutes 47 seconds: Script exited with non-zero exit status: 1. Allowed exit codes are: [0]

2024-01-15 09:27:34 [ERROR] Build failed with exit code 1
2024-01-15 09:27:34 [ERROR] Provisioner 'shell' (scripts/install-packages.sh) failed
2024-01-15 09:27:34 [INFO] Cleaning up build artifacts...
2024-01-15 09:27:35 [INFO] Build cleanup completed

==> Wait completed after 3 minutes 47 seconds

==> Some builds didn't complete successfully and had errors:
--> ubuntu-2204-base: Script exited with non-zero exit status: 1. Allowed exit codes are: [0]

==> Builds finished but no artifacts were created.

2024-01-15 09:27:35 [INFO] Packer build process terminated
2024-01-15 09:27:35 [ERROR] Build failed - no image artifacts created
2024-01-15 09:27:35 [INFO] Exit code: 1