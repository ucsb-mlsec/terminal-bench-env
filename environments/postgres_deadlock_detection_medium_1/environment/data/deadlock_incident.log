2024-01-15 14:23:45.678 UTC [45231] ERROR:  deadlock detected
2024-01-15 14:23:45.678 UTC [45231] DETAIL:  Process 45231 waits for ShareLock on transaction 892341; blocked by process 45289.
Process 45289 waits for ExclusiveLock on transaction 892342; blocked by process 45312.
Process 45312 waits for ShareLock on transaction 892340; blocked by process 45231.
Process 45231: UPDATE orders SET status = 'processing', updated_at = '2024-01-15 14:23:45' WHERE order_id = 78923;
Process 45289: UPDATE inventory SET quantity = quantity - 5, last_modified = now() WHERE product_id = 4521 AND warehouse_id = 12;
Process 45312: UPDATE payments SET payment_status = 'confirmed', processed_at = now() WHERE payment_id = 55812;
2024-01-15 14:23:45.678 UTC [45231] HINT:  See server log for query details.
2024-01-15 14:23:45.678 UTC [45231] CONTEXT:  while updating tuple (0,127) in relation "orders"
2024-01-15 14:23:45.678 UTC [45231] STATEMENT:  UPDATE orders SET status = 'processing', updated_at = '2024-01-15 14:23:45' WHERE order_id = 78923;
2024-01-15 14:23:45.679 UTC [45289] LOG:  process 45289 detected deadlock while waiting for ShareLock on transaction 892342 after 1000.152 ms
2024-01-15 14:23:45.679 UTC [45289] DETAIL:  Process holding the lock: 45312. Wait queue: 45289.
2024-01-15 14:23:45.679 UTC [45289] STATEMENT:  UPDATE inventory SET quantity = quantity - 5, last_modified = now() WHERE product_id = 4521 AND warehouse_id = 12;
2024-01-15 14:23:45.680 UTC [45312] LOG:  process 45312 still waiting for ExclusiveLock on tuple (0,89) of relation 16445 of database 16384 after 1001.234 ms
2024-01-15 14:23:45.680 UTC [45312] DETAIL:  Process holding the lock: 45231. Wait queue: 45312.
2024-01-15 14:23:45.680 UTC [45312] CONTEXT:  while locking tuple (0,89) in relation "payments"
2024-01-15 14:23:45.680 UTC [45312] STATEMENT:  UPDATE payments SET payment_status = 'confirmed', processed_at = now() WHERE payment_id = 55812;
2024-01-15 14:23:45.681 UTC [45231] LOG:  process 45231 acquired ShareLock on transaction 892343 after 956.421 ms
2024-01-15 14:23:45.682 UTC [45231] ERROR:  deadlock detected
2024-01-15 14:23:45.682 UTC [45231] DETAIL:  Process 45231 waits for ShareLock on transaction 892341; blocked by process 45289.
Process 45289 waits for ExclusiveLock on transaction 892342; blocked by process 45312.
Process 45312 waits for ShareLock on transaction 892340; blocked by process 45231.
Process 45231: UPDATE orders SET status = 'processing', updated_at = '2024-01-15 14:23:45' WHERE order_id = 78923;
Process 45289: UPDATE inventory SET quantity = quantity - 5, last_modified = now() WHERE product_id = 4521 AND warehouse_id = 12;
Process 45312: UPDATE payments SET payment_status = 'confirmed', processed_at = now() WHERE payment_id = 55812;
2024-01-15 14:23:45.682 UTC [45231] HINT:  See server log for query details.
2024-01-15 14:23:45.682 UTC [45231] CONTEXT:  while updating tuple (0,127) in relation "orders"
2024-01-15 14:23:45.683 UTC [45289] ERROR:  deadlock detected
2024-01-15 14:23:45.683 UTC [45289] DETAIL:  Process 45289 waits for ExclusiveLock on tuple (0,201) of relation "inventory"; blocked by process 45312.
Process 45312 waits for ShareLock on tuple (0,89) of relation "payments"; blocked by process 45231.
Process 45231 waits for ExclusiveLock on tuple (0,156) of relation "orders"; blocked by process 45289.
2024-01-15 14:23:45.683 UTC [45289] HINT:  See server log for query details.
2024-01-15 14:23:45.683 UTC [45289] CONTEXT:  while locking tuple (0,201) in relation "inventory"
2024-01-15 14:23:45.683 UTC [45289] STATEMENT:  UPDATE inventory SET quantity = quantity - 5, last_modified = now() WHERE product_id = 4521 AND warehouse_id = 12;
2024-01-15 14:23:45.684 UTC [45231] LOG:  process 45231 still waiting for ShareLock on transaction 892341 after 1002.456 ms
2024-01-15 14:23:45.684 UTC [45231] DETAIL:  Process holding the lock: 45289. Wait queue: 45231, 45387.
2024-01-15 14:23:45.685 UTC [45312] ERROR:  current transaction is aborted, commands ignored until end of transaction block
2024-01-15 14:23:45.685 UTC [45312] HINT:  In a moment you should be able to reconnect and retry your transaction.
2024-01-15 14:23:45.686 UTC [45312] LOG:  process 45312 was terminated to resolve deadlock
2024-01-15 14:23:45.686 UTC [45312] DETAIL:  Process 45312 waits for ShareLock on transaction 892340; blocked by process 45231.
2024-01-15 14:23:45.687 UTC [45289] LOG:  process 45289 acquired ExclusiveLock on tuple (0,201) of relation "inventory" after 1003.891 ms
2024-01-15 14:23:45.688 UTC [45231] LOG:  process 45231 acquired ShareLock on transaction 892341 after 1004.123 ms
2024-01-15 14:23:45.690 UTC [45231] LOG:  duration: 1005.234 ms  statement: UPDATE orders SET status = 'processing', updated_at = '2024-01-15 14:23:45' WHERE order_id = 78923;
2024-01-15 14:23:45.691 UTC [45289] LOG:  duration: 1006.456 ms  statement: UPDATE inventory SET quantity = quantity - 5, last_modified = now() WHERE product_id = 4521 AND warehouse_id = 12;
2024-01-15 14:23:45.692 UTC [45312] LOG:  connection received: host=10.0.1.45 port=54321
2024-01-15 14:23:45.693 UTC [45312] LOG:  connection authorized: user=app_user database=ecommerce_db application_name=order_processor