CREATE DATABASE IF NOT EXISTS sales_db;

USE sales_db;

CREATE TABLE IF NOT EXISTS orders
(
    order_id UInt64,
    order_date Date,
    customer_id UInt32,
    amount Decimal64(2),
    created_at DateTime
) ENGINE = MergeTree()
ORDER BY order_date;

CREATE MATERIALIZED VIEW IF NOT EXISTS daily_sales_summary
ENGINE = SummingMergeTree()
ORDER BY sale_date
AS SELECT 
    order_date AS sale_date,
    sum(amount) AS total_amount
FROM orders
GROUP BY order_date;

INSERT INTO orders VALUES
(1001, '2024-02-01', 10001, 1250.75, '2024-02-01 09:15:30'),
(1002, '2024-02-01', 10002, 890.50, '2024-02-01 10:22:15'),
(1003, '2024-02-01', 10003, 2340.00, '2024-02-01 14:35:45'),
(1004, '2024-02-02', 10004, 1567.80, '2024-02-02 08:45:20'),
(1005, '2024-02-02', 10005, 945.25, '2024-02-02 11:30:10'),
(1006, '2024-02-03', 10006, 3200.00, '2024-02-03 09:10:05'),
(1007, '2024-02-03', 10007, 1876.90, '2024-02-03 13:25:40'),
(1008, '2024-02-03', 10008, 756.50, '2024-02-03 16:45:55'),
(1009, '2024-02-04', 10009, 2145.60, '2024-02-04 10:05:25'),
(1010, '2024-02-04', 10010, 1234.75, '2024-02-04 15:20:30'),
(1011, '2024-02-05', 10011, 3456.80, '2024-02-05 09:30:15'),
(1012, '2024-02-05', 10012, 987.40, '2024-02-05 12:15:50'),
(1013, '2024-02-06', 10013, 2789.00, '2024-02-06 08:50:10'),
(1014, '2024-02-06', 10014, 1543.20, '2024-02-06 14:40:35'),
(1015, '2024-02-07', 10015, 4123.50, '2024-02-07 10:25:45'),
(1016, '2024-02-07', 10016, 876.90, '2024-02-07 16:10:20'),
(1017, '2024-02-08', 10017, 2567.30, '2024-02-08 09:45:55'),
(1018, '2024-02-08', 10018, 1890.75, '2024-02-08 13:30:40'),
(1019, '2024-02-09', 10019, 3340.00, '2024-02-09 11:20:15'),
(1020, '2024-02-09', 10020, 1456.85, '2024-02-09 15:50:30'),
(1021, '2024-02-10', 10021, 2234.60, '2024-02-10 08:15:25'),
(1022, '2024-02-10', 10022, 1678.40, '2024-02-10 12:45:10'),
(1023, '2024-02-11', 10023, 3890.25, '2024-02-11 09:35:50'),
(1024, '2024-02-11', 10024, 945.70, '2024-02-11 14:20:35'),
(1025, '2024-02-12', 10025, 2756.90, '2024-02-12 10:55:20'),
(1026, '2024-02-12', 10026, 1567.30, '2024-02-12 16:30:45'),
(1027, '2024-02-13', 10027, 4234.80, '2024-02-13 09:10:15'),
(1028, '2024-02-13', 10028, 1123.50, '2024-02-13 13:40:55'),
(1029, '2024-02-14', 10029, 2890.00, '2024-02-14 08:25:30'),
(1030, '2024-02-14', 10030, 1745.60, '2024-02-14 12:15:40'),
(1031, '2024-02-15', 10031, 3567.80, '2024-02-15 10:40:20'),
(1032, '2024-02-15', 10032, 1234.90, '2024-02-15 15:25:10'),
(1033, '2024-02-16', 10033, 2456.70, '2024-02-16 09:50:45'),
(1034, '2024-02-16', 10034, 1876.40, '2024-02-16 14:10:25'),
(1035, '2024-02-17', 10035, 3123.50, '2024-02-17 11:30:35'),
(1036, '2024-02-17', 10036, 1567.20, '2024-02-17 16:45:50'),
(1037, '2024-02-18', 10037, 2789.60, '2024-02-18 08:55:15'),
(1038, '2024-02-18', 10038, 1345.80, '2024-02-18 13:20:40'),
(1039, '2024-02-19', 10039, 3890.00, '2024-02-19 10:15:55'),
(1040, '2024-02-19', 10040, 1678.90, '2024-02-19 15:40:20'),
(1041, '2024-02-20', 10041, 2567.40, '2024-02-20 09:25:30'),
(1042, '2024-02-20', 10042, 1234.60, '2024-02-20 14:50:45'),
(1043, '2024-02-21', 10043, 3456.70, '2024-02-21 11:10:10'),
(1044, '2024-02-21', 10044, 1890.30, '2024-02-21 16:35:25'),
(1045, '2024-02-22', 10045, 2678.90, '2024-02-22 08:40:50'),
(1046, '2024-02-22', 10046, 1456.20, '2024-02-22 13:15:35'),
(1047, '2024-02-23', 10047, 3234.50, '2024-02-23 10:30:15'),
(1048, '2024-02-23', 10048, 1567.80, '2024-02-23 15:55:40'),
(1049, '2024-02-24', 10049, 2890.60, '2024-02-24 09:20:25'),
(1050, '2024-02-24', 10050, 1745.30, '2024-02-24 14:45:55'),
(1051, '2024-02-25', 10051, 3567.90, '2024-02-25 11:05:10'),
(1052, '2024-02-25', 10052, 1234.70, '2024-02-25 16:30:30'),
(1053, '2024-02-26', 10053, 2456.80, '2024-02-26 08:50:45'),
(1054, '2024-02-26', 10054, 1876.50, '2024-02-26 13:25:20'),
(1055, '2024-02-27', 10055, 3123.60, '2024-02-27 10:45:35'),
(1056, '2024-02-27', 10056, 1567.40, '2024-02-27 15:10:50'),
(1057, '2024-02-28', 10057, 2789.70, '2024-02-28 09:35:15'),
(1058, '2024-02-28', 10058, 1345.90, '2024-02-28 14:00:40'),
(1059, '2024-02-29', 10059, 3890.20, '2024-02-29 11:25:55'),
(1060, '2024-02-29', 10060, 1678.60, '2024-02-29 16:50:20'),
(1061, '2024-03-01', 10061, 2567.50, '2024-03-01 08:15:30'),
(1062, '2024-03-01', 10062, 1234.80, '2024-03-01 12:40:45'),
(1063, '2024-03-02', 10063, 3456.90, '2024-03-02 10:05:10'),
(1064, '2024-03-02', 10064, 1890.40, '2024-03-02 15:30:25'),
(1065, '2024-03-03', 10065, 2678.70, '2024-03-03 09:50:50'),
(1066, '2024-03-03', 10066, 1456.30, '2024-03-03 14:15:35'),
(1067, '2024-03-04', 10067, 3234.60, '2024-03-04 11:40:15'),
(1068, '2024-03-04', 10068, 1567.90, '2024-03-04 16:05:40'),
(1069, '2024-03-05', 10069, 2890.80, '2024-03-05 08:30:25'),
(1070, '2024-03-05', 10070, 1745.40, '2024-03-05 13:55:55'),
(1071, '2024-03-06', 10071, 3567.20, '2024-03-06 10:20:10'),
(1072, '2024-03-06', 10072, 1234.50, '2024-03-06 15:45:30'),
(1073, '2024-03-07', 10073, 2456.90, '2024-03-07 09:10:45'),
(1074, '2024-03-07', 10074, 1876.60, '2024-03-07 14:35:20'),
(1075, '2024-03-08', 10075, 3123.80, '2024-03-08 11:00:35'),
(1076, '2024-03-08', 10076, 1567.30, '2024-03-08 16:25:50'),
(1077, '2024-03-09', 10077, 2789.50, '2024-03-09 08:45:15'),
(1078, '2024-03-09', 10078, 1345.70, '2024-03-09 13:10:40'),
(1079, '2024-03-10', 10079, 3890.40, '2024-03-10 10:35:55'),
(1080, '2024-03-10', 10080, 1678.80, '2024-03-10 15:00:20'),
(1081, '2024-03-11', 10081, 2567.60, '2024-03-11 09:25:30'),
(1082, '2024-03-11', 10082, 1234.90, '2024-03-11 14:50:45'),
(1083, '2024-03-12', 10083, 3456.30, '2024-03-12 11:15:10'),
(1084, '2024-03-12', 10084, 1890.50, '2024-03-12 16:40:25'),
(1085, '2024-03-13', 10085, 2678.80, '2024-03-13 08:05:50'),
(1086, '2024-03-13', 10086, 1456.40, '2024-03-13 12:30:35'),
(1087, '2024-03-14', 10087, 3234.70, '2024-03-14 09:55:15'),
(1088, '2024-03-14', 10088, 1567.60, '2024-03-14 14:20:40'),
(1089, '2024-03-15', 10089, 2890.90, '2024-03-15 10:45:25'),
(1090, '2024-03-15', 10090, 1745.50, '2024-03-15 15:10:55');

INSERT INTO orders VALUES
(1091, '2024-02-03', 10091, 1100.25, '2024-02-03 17:30:10'),
(1092, '2024-02-05', 10092, 2200.50, '2024-02-05 18:15:20'),
(1093, '2024-02-08', 10093, 1650.75, '2024-02-08 17:45:30'),
(1094, '2024-02-11', 10094, 1980.40, '2024-02-11 18:30:40'),
(1095, '2024-02-14', 10095, 2150.60, '2024-02-14 17:20:50'),
(1096, '2024-02-17', 10096, 1750.80, '2024-02-17 18:05:15'),
(1097, '2024-02-20', 10097, 2350.90, '2024-02-20 17:50:25'),
(1098, '2024-02-23', 10098, 1850.30, '2024-02-23 18:40:35'),
(1099, '2024-02-26', 10099, 2050.70, '2024-02-26 17:15:45'),
(1100, '2024-02-29', 10100, 1950.50, '2024-02-29 18:25:55'),
(1101, '2024-03-03', 10101, 2250.40, '2024-03-03 17:35:10'),
(1102, '2024-03-06', 10102, 1550.60, '2024-03-06 18:20:20'),
(1103, '2024-03-09', 10103, 2450.80, '2024-03-09 17:55:30'),
(1104, '2024-03-12', 10104, 1650.90, '2024-03-12 18:10:40'),
(1105, '2024-03-15', 10105, 2150.20, '2024-03-15 17:40:50'),
(1106, '2024-02-01', 10106, 1320.45, '2024-02-01 16:25:15'),
(1107, '2024-02-04', 10107, 1780.55, '2024-02-04 17:10:25'),
(1108, '2024-02-07', 10108, 1920.65, '2024-02-07 18:35:35'),
(1109, '2024-02-10', 10109, 2120.75, '2024-02-10 17:00:45'),
(1110, '2024-02-13', 10110, 1680.85, '2024-02-13 18:45:55'),
(1111, '2024-02-16', 10111, 2280.95, '2024-02-16 17:30:10'),
(1112, '2024-02-19', 10112, 1580.35, '2024-02-19 18:15:20'),
(1113, '2024-02-22', 10113, 2380.45, '2024-02-22 17:50:30'),
(1114, '2024-02-25', 10114, 1880.55, '2024-02-25 18:25:40'),
(1115, '2024-02-28', 10115, 2080.65, '2024-02-28 17:10:50'),
(1116, '2024-03-02', 10116, 1980.75, '2024-03-02 18:35:15'),
(1117, '2024-03-05', 10117, 2180.85, '2024-03-05 17:20:25'),
(1118, '2024-03-08', 10118, 1780.95, '2024-03-08 18:05:35'),
(1119, '2024-03-11', 10119, 2480.25, '2024-03-11 17:45:45'),
(1120, '2024-03-14', 10120, 1680.35, '2024-03-14 18:30:55'),
(1121, '2024-02-02', 10121, 1425.70, '2024-02-02 16:40:20'),
(1122, '2024-02-06', 10122, 1825.80, '2024-02-06 17:25:30'),
(1123, '2024-02-09', 10123, 1625.90, '2024-02-09 18:50:40'),
(1124, '2024-02-12', 10124, 2225.10, '2024-02-12 17:15:50'),
(1125, '2024-02-15', 10125, 1725.20, '2024-02-15 18:00:15'),
(1126, '2024-02-18', 10126, 2325.30, '2024-02-18 17:35:25'),
(1127, '2024-02-21', 10127, 1525.40, '2024-02-21 18:20:35'),
(1128, '2024-02-24', 10128, 2425.50, '2024-02-24 17:05:45'),
(1129, '2024-02-27', 10129, 1925.60, '2024-02-27 18:45:55'),
(1130, '2024-03-01', 10130, 2025.70, '2024-03-01 17:30:10'),
(1131, '2024-03-04', 10131, 2125.80, '2024-03-04 18:15:20'),
(1132, '2024-03-07', 10132, 1625.90, '2024-03-07 17:50:30'),
(1133, '2024-03-10', 10133, 2525.15, '2024-03-10 18:35:40'),
(1134, '2024-03-13', 10134, 1725.25, '2024-03-13 17:20:50'),
(1135, '2024-03-15', 10135, 2225.35, '2024-03-15 18:05:15');