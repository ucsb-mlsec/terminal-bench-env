[2024-01-15T10:23:45.123Z] [payment-processor-1] INFO  com.payment.PaymentService - Payment service started successfully
[2024-01-15T10:24:12.456Z] [payment-processor-1] INFO  com.payment.PaymentController - Received payment request for transaction ID: TXN-20240115-001
[2024-01-15T10:24:13.789Z] [payment-processor-1] ERROR com.payment.PaymentProcessor - Failed to process payment transaction
java.lang.NullPointerException: Cannot invoke method on null payment object
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:156)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:974)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:877)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.net.SocketTimeoutException: Read timed out
	at java.net.SocketInputStream.read(SocketInputStream.java:162)
	at java.net.SocketInputStream.read(SocketInputStream.java:140)
	at com.payment.external.BankApiClient.readResponse(BankApiClient.java:245)
	... 8 more
[2024-01-15T10:25:34.567Z] [pool-2-thread-5] INFO  com.payment.TransactionLogger - Transaction TXN-20240115-001 marked as failed
[2024-01-15T10:26:45.890Z] [payment-processor-2] DEBUG com.payment.RetryHandler - Attempting retry for transaction TXN-20240115-002
[2024-01-15T10:27:12.234Z] [payment-processor-2] ERROR com.payment.TransactionValidator - Validation failed for transaction
java.lang.NullPointerException: Payment details cannot be null
	at com.payment.TransactionValidator.validate(TransactionValidator.java:92)
	at com.payment.PaymentProcessor.preProcess(PaymentProcessor.java:134)
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:145)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:974)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.lang.IllegalStateException: Transaction context not initialized
	at com.payment.context.TransactionContext.getCurrentContext(TransactionContext.java:67)
	at com.payment.TransactionValidator.getContext(TransactionValidator.java:88)
	... 9 more
[2024-01-15T10:28:23.456Z] [payment-processor-1] WARN  com.payment.RetryHandler - Retry attempt 1 of 3 for transaction TXN-20240115-003
[2024-01-15T10:29:45.678Z] [payment-processor-3] INFO  com.payment.PaymentController - Received payment request for transaction ID: TXN-20240115-004
[2024-01-15T10:30:12.901Z] [payment-processor-3] ERROR com.payment.external.BankApiClient - Timeout while communicating with bank API
java.util.concurrent.TimeoutException: Bank API request timed out after 5000ms
	at com.payment.external.BankApiClient.executeRequest(BankApiClient.java:189)
	at com.payment.external.BankApiClient.processPayment(BankApiClient.java:156)
	at com.payment.PaymentProcessor.executeBankTransaction(PaymentProcessor.java:234)
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:167)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.net.SocketTimeoutException: connect timed out
	at java.base/java.net.PlainSocketImpl.waitForConnect(PlainSocketImpl.java:589)
	at java.base/java.net.PlainSocketImpl.socketConnect(PlainSocketImpl.java:120)
	at com.payment.external.BankApiClient.createConnection(BankApiClient.java:267)
	... 9 more
Suppressed: java.sql.SQLException: Connection already closed
		at com.payment.db.ConnectionPool.getConnection(ConnectionPool.java:45)
		at com.payment.db.TransactionRepository.save(TransactionRepository.java:123)
		at com.payment.PaymentProcessor.logTransaction(PaymentProcessor.java:201)
[2024-01-15T11:15:34.123Z] [payment-processor-1] INFO  com.payment.TransactionLogger - Transaction TXN-20240115-004 marked as timeout
[2024-01-15T11:16:45.234Z] [pool-2-thread-7] DEBUG com.payment.MetricsCollector - Recording payment failure metric
[2024-01-15T11:18:56.345Z] [payment-processor-4] ERROR com.payment.PaymentProcessor - Payment processing failed
java.lang.NullPointerException: Customer account object is null
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:156)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:974)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:877)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2024-01-15T11:19:23.456Z] [payment-processor-2] INFO  com.payment.PaymentService - Processing transaction batch: BATCH-001
[2024-01-15T11:20:45.567Z] [payment-processor-2] ERROR com.payment.FundsManager - Insufficient funds for transaction
com.payment.InsufficientFundsException: Account balance (450.00) is less than transaction amount (525.00)
	at com.payment.FundsManager.checkBalance(FundsManager.java:78)
	at com.payment.FundsManager.reserveFunds(FundsManager.java:56)
	at com.payment.PaymentProcessor.processFunds(PaymentProcessor.java:189)
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:167)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:974)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: com.payment.db.DatabaseException: Failed to query account balance
	at com.payment.db.AccountRepository.getBalance(AccountRepository.java:145)
	at com.payment.FundsManager.checkBalance(FundsManager.java:74)
	... 10 more
Caused by: java.sql.SQLTransientException: Connection timeout
	at org.postgresql.jdbc.PgConnection.executeQuery(PgConnection.java:456)
	at com.payment.db.AccountRepository.executeQuery(AccountRepository.java:167)
	... 12 more
[2024-01-15T12:34:12.678Z] [payment-processor-5] WARN  com.payment.CircuitBreaker - Circuit breaker opened for bank API
[2024-01-15T12:35:23.789Z] [payment-processor-1] INFO  com.payment.PaymentController - Received payment request for transaction ID: TXN-20240115-005
[2024-01-15T12:36:34.890Z] [payment-processor-1] ERROR com.payment.PaymentProcessor - Critical error during payment processing
java.lang.NullPointerException: Payment method configuration is null
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:156)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:974)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:877)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: com.payment.config.ConfigurationException: Payment gateway configuration not found
	at com.payment.config.ConfigurationManager.getPaymentConfig(ConfigurationManager.java:234)
	at com.payment.PaymentProcessor.initialize(PaymentProcessor.java:98)
	... 8 more
Suppressed: java.io.IOException: Failed to load configuration file
		at com.payment.config.FileConfigLoader.loadConfig(FileConfigLoader.java:67)
		at com.payment.config.ConfigurationManager.refresh(ConfigurationManager.java:189)
[2024-01-15T13:45:45.901Z] [pool-2-thread-3] DEBUG com.payment.CacheManager - Cache miss for configuration key: payment.gateway.primary
[2024-01-15T13:46:56.012Z] [payment-processor-3] INFO  com.payment.HealthCheck - Health check passed
[2024-01-15T14:12:23.123Z] [payment-processor-2] ERROR com.payment.external.BankApiClient - Bank API communication failure
java.util.concurrent.TimeoutException: Request timeout waiting for bank response
	at com.payment.external.BankApiClient.waitForResponse(BankApiClient.java:312)
	at com.payment.external.BankApiClient.executeRequest(BankApiClient.java:189)
	at com.payment.external.BankApiClient.processPayment(BankApiClient.java:156)
	at com.payment.PaymentProcessor.executeBankTransaction(PaymentProcessor.java:234)
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:167)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2024-01-15T14:13:34.234Z] [payment-processor-4] WARN  com.payment.RetryHandler - Maximum retry attempts reached for transaction TXN-20240115-006
[2024-01-15T14:15:45.345Z] [payment-processor-1] INFO  com.payment.PaymentController - Received payment request for transaction ID: TXN-20240115-007
[2024-01-15T14:16:56.456Z] [payment-processor-1] ERROR com.payment.TransactionValidator - Transaction validation error
java.lang.NullPointerException: Merchant details are null
	at com.payment.TransactionValidator.validate(TransactionValidator.java:92)
	at com.payment.PaymentProcessor.preProcess(PaymentProcessor.java:134)
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:145)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:974)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: com.payment.merchant.MerchantNotFoundException: Merchant ID not found: MERCH-12345
	at com.payment.merchant.MerchantService.getMerchant(MerchantService.java:123)
	at com.payment.TransactionValidator.loadMerchant(TransactionValidator.java:87)
	... 9 more
[2024-01-15T15:23:12.567Z] [pool-2-thread-9] INFO  com.payment.TransactionLogger - Daily transaction summary generated
[2024-01-15T15:24:23.678Z] [payment-processor-5] DEBUG com.payment.SecurityFilter - Authentication successful for user: merchant_user_123
[2024-01-15T15:26:34.789Z] [payment-processor-3] ERROR com.payment.network.SocketHandler - Network communication error
java.net.SocketTimeoutException: Read timed out after 30000ms
	at java.base/java.net.SocketInputStream.socketRead0(Native Method)
	at java.base/java.net.SocketInputStream.socketRead(SocketInputStream.java:115)
	at java.base/java.net.SocketInputStream.read(SocketInputStream.java:168)
	at com.payment.network.SocketHandler.readData(SocketHandler.java:234)
	at com.payment.external.BankApiClient.receiveData(BankApiClient.java:289)
	at com.payment.external.BankApiClient.executeRequest(BankApiClient.java:195)
	at com.payment.external.BankApiClient.processPayment(BankApiClient.java:156)
	at com.payment.PaymentProcessor.executeBankTransaction(PaymentProcessor.java:234)
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:167)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.io.IOException: Stream closed unexpectedly
	at java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:263)
	at com.payment.network.SocketHandler.readBytes(SocketHandler.java:267)
	... 11 more
[2024-01-15T16:34:45.890Z] [payment-processor-2] INFO  com.payment.PaymentService - Processing high-priority transaction
[2024-01-15T16:35:56.901Z] [payment-processor-2] ERROR com.payment.FundsManager - Fund reservation failed
com.payment.InsufficientFundsException: Unable to reserve funds: Account balance insufficient
	at com.payment.FundsManager.reserveFunds(FundsManager.java:67)
	at com.payment.PaymentProcessor.processFunds(PaymentProcessor.java:189)
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:167)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:974)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2024-01-15T17:45:12.012Z] [pool-2-thread-11] WARN  com.payment.AlertManager - Alert triggered: High failure rate detected
[2024-01-15T17:46:23.123Z] [payment-processor-4] INFO  com.payment.PaymentController - Received payment request for transaction ID: TXN-20240115-008
[2024-01-15T17:47:34.234Z] [payment-processor-4] ERROR com.payment.PaymentProcessor - Unexpected null reference during processing
java.lang.NullPointerException: Transaction metadata is null
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:156)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:974)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:877)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: com.payment.metadata.MetadataException: Failed to retrieve transaction metadata
	at com.payment.metadata.MetadataService.getMetadata(MetadataService.java:89)
	at com.payment.PaymentProcessor.loadTransactionData(PaymentProcessor.java:145)
	... 8 more
Caused by: redis.clients.jedis.exceptions.JedisConnectionException: Failed to connect to Redis
	at redis.clients.jedis.Connection.connect(Connection.java:207)
	at com.payment.cache.RedisCache.get(RedisCache.java:56)
	... 10 more
Suppressed: java.net.ConnectException: Connection refused
		at java.base/java.net.PlainSocketImpl.connect0(Native Method)
		at redis.clients.jedis.Connection.createSocket(Connection.java:178)
[2024-01-15T18:56:45.345Z] [payment-processor-1] DEBUG com.payment.RateLimiter - Rate limit check passed for merchant: MERCH-67890
[2024-01-15T18:58:56.456Z] [payment-processor-5] INFO  com.payment.PaymentService - Transaction processing statistics updated
[2024-01-15T19:12:23.567Z] [payment-processor-3] ERROR com.payment.external.BankApiClient - Timeout during bank API call
java.util.concurrent.TimeoutException: Future timed out after 10 seconds
	at java.base/java.util.concurrent.CompletableFuture.timedGet(CompletableFuture.java:1886)
	at com.payment.external.BankApiClient.awaitResponse(BankApiClient.java:345)
	at com.payment.external.BankApiClient.executeRequest(BankApiClient.java:189)
	at com.payment.external.BankApiClient.processPayment(BankApiClient.java:156)
	at com.payment.PaymentProcessor.executeBankTransaction(PaymentProcessor.java:234)
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:167)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at java.base/java.lang.Thread.run(Thread.java:829)
Caused by: java.util.concurrent.ExecutionException: Request execution failed
	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at com.payment.external.AsyncExecutor.execute(AsyncExecutor.java:123)
	... 9 more
[2024-01-15T20:23:34.678Z] [pool-2-thread-13] INFO  com.payment.BackgroundTask - Cleanup task completed successfully
[2024-01-15T20:25:45.789Z] [payment-processor-2] WARN  com.payment.MonitoringAgent - Memory usage above threshold: 85%
[2024-01-15T21:34:56.890Z] [payment-processor-1] ERROR com.payment.validation.AmountValidator - Invalid transaction amount
java.lang.IllegalArgumentException: Transaction amount cannot be negative: -150.00
	at com.payment.validation.AmountValidator.validateAmount(AmountValidator.java:45)
	at com.payment.validation.AmountValidator.validate(AmountValidator.java:34)
	at com.payment.PaymentProcessor.validateTransaction(PaymentProcessor.java:123)
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:152)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2024-01-15T22:45:12.901Z] [payment-processor-4] INFO  com.payment.PaymentController - Received payment request for transaction ID: TXN-20240115-009
[2024-01-15T22:46:23.012Z] [payment-processor-4] ERROR com.payment.PaymentProcessor - Payment processing encountered null reference
java.lang.NullPointerException: Payment gateway instance is null
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:156)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at com.payment.api.RestHandler.process(RestHandler.java:234)
	at com.payment.api.PaymentEndpoint.doPost(PaymentEndpoint.java:123)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:647)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:974)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:877)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2024-01-15T23:12:34.123Z] [pool-2-thread-15] DEBUG com.payment.ScheduledTask - Scheduled maintenance task executed
[2024-01-15T23:15:45.234Z] [payment-processor-5] INFO  com.payment.ReportGenerator - Generating end-of-day payment report
[2024-01-15T23:45:56.345Z] [payment-processor-3] ERROR com.payment.network.ConnectionManager - Socket timeout during data transfer
java.net.SocketTimeoutException: Socket read timeout after 20000ms
	at java.base/sun.nio.ch.NioSocketImpl.timedRead(NioSocketImpl.java:283)
	at java.base/sun.nio.ch.NioSocketImpl.implRead(NioSocketImpl.java:309)
	at com.payment.network.ConnectionManager.readFromSocket(ConnectionManager.java:178)
	at com.payment.external.BankApiClient.receiveData(BankApiClient.java:289)
	at com.payment.external.BankApiClient.executeRequest(BankApiClient.java:195)
	at com.payment.external.BankApiClient.processPayment(BankApiClient.java:156)
	at com.payment.PaymentProcessor.executeBankTransaction(PaymentProcessor.java:234)
	at com.payment.PaymentProcessor.processTransaction(PaymentProcessor.java:167)
	at com.payment.PaymentController.handlePayment(PaymentController.java:78)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2024-01-15T23:56:12.456Z] [payment-processor-1] INFO  com.payment.PaymentService - Payment service shutting down gracefully
[2024-01-15T23:58:23.567Z] [payment-processor-2] WARN  com.payment.ShutdownHook - Waiting for pending transactions to complete
[2024-01-15T23:59:34.678Z] [pool-2-thread-1] INFO  com.payment.ThreadPoolManager - Thread pool shutdown complete