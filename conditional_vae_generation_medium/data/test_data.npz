import numpy as np

# Create realistic test data for CVAE
np.random.seed(42)

# Create 10 samples with shape (10, 784)
# Simulating flattened 28x28 grayscale images with realistic patterns
x_test = np.zeros((10, 784), dtype=np.float32)

for i in range(10):
    # Create a base pattern for each digit
    img = np.zeros((28, 28), dtype=np.float32)
    
    # Add some realistic structure to each image
    # Center region with higher intensity
    center_y, center_x = 14, 14
    y_grid, x_grid = np.meshgrid(np.arange(28), np.arange(28), indexing='ij')
    
    # Create distance-based patterns
    dist = np.sqrt((y_grid - center_y)**2 + (x_grid - center_x)**2)
    
    # Different pattern for each digit
    if i == 0:  # Circle-like pattern
        img = np.where(dist < 10, 0.7, 0.0) * np.where(dist > 6, 1.0, 0.0)
    elif i == 1:  # Vertical line
        img[:, 12:16] = 0.8
    elif i == 2:  # Curved pattern
        img[5:10, 8:20] = 0.7
        img[12:16, 8:20] = 0.7
        img[20:25, 8:20] = 0.7
    elif i == 3:  # Another curved pattern
        img[5:10, 10:20] = 0.75
        img[12:16, 10:20] = 0.75
        img[20:25, 10:20] = 0.75
    elif i == 4:  # Cross pattern
        img[:, 13:15] = 0.65
        img[12:14, :] = 0.65
    elif i == 5:  # S-like pattern
        img[5:10, 8:20] = 0.7
        img[12:16, 8:14] = 0.7
        img[20:25, 8:20] = 0.7
    elif i == 6:  # Loop pattern
        img = np.where(dist < 10, 0.6, 0.0)
        img[8:20, 10:18] = 0.6
    elif i == 7:  # Diagonal
        for j in range(28):
            if j < 24:
                img[j, 24-j] = 0.75
    elif i == 8:  # Double circle
        img = np.where(dist < 10, 0.65, 0.0) * np.where(dist > 6, 1.0, 0.0)
        img = np.where(dist < 9, np.maximum(img, 0.65), img)
    else:  # 9 - circle with stem
        img = np.where(dist < 8, 0.7, 0.0)
        img[15:25, 13:15] = 0.7
    
    # Add some noise to make it more realistic
    noise = np.random.normal(0, 0.05, (28, 28))
    img = np.clip(img + noise, 0, 1)
    
    # Flatten and store
    x_test[i] = img.flatten()

# Normalize to ensure values are between 0 and 1
x_test = np.clip(x_test, 0, 1)

# Create labels 0-9
y_test = np.arange(10, dtype=np.int64)

# Save as npz file
np.savez('/workspace/test_data.npz', x_test=x_test, y_test=y_test)