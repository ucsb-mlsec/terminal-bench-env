# FreeSurfer recon-all processing log
# Build stamp: freesurfer-linux-centos7_x86_64-7.3.2-20210917-aa8f91b
# Started at: Mon Jan 15 17:12:45 UTC 2024
#
# Subject ID: subject_003
# SUBJECTS_DIR: /data/freesurfer/subjects
# Command: recon-all -s subject_003 -all -qcache
#
#---------------------------------
# Hostname: neuroimaging-server-01
# Machine: x86_64
# User: fsuser
# Date: Mon Jan 15 17:12:45 UTC 2024
#---------------------------------

#--------------------------------------------
#@# Motion Correction Mon Jan 15 17:12:46 UTC 2024
mri_motion_cor -i /data/raw/subject_003/T1.nii.gz -o /data/freesurfer/subjects/subject_003/mri/rawavg.mgz
reading from /data/raw/subject_003/T1.nii.gz...
TR=2500.00, TE=3.50, TI=900.00, flip angle=9.00
i_ras = (-1, 0, 0)
j_ras = (0, 0, -1)
k_ras = (0, 1, 0)
writing to /data/freesurfer/subjects/subject_003/mri/rawavg.mgz
Motion correction completed successfully
mri_motion_cor finished without error at Mon Jan 15 17:13:12 UTC 2024

#--------------------------------------------
#@# Conforming to 1mm voxel size Mon Jan 15 17:13:12 UTC 2024
mri_convert /data/freesurfer/subjects/subject_003/mri/rawavg.mgz /data/freesurfer/subjects/subject_003/mri/orig.mgz --conform
reading from /data/freesurfer/subjects/subject_003/mri/rawavg.mgz...
conforming width to 256
conforming height to 256
conforming depth to 256
conforming voxel size to 1.00mm
writing to /data/freesurfer/subjects/subject_003/mri/orig.mgz...
mri_convert finished without error at Mon Jan 15 17:13:28 UTC 2024

#--------------------------------------------
#@# Intensity Normalization Mon Jan 15 17:13:28 UTC 2024
mri_normalize -g 1 -mprage /data/freesurfer/subjects/subject_003/mri/orig.mgz /data/freesfer/subjects/subject_003/mri/T1.mgz
reading input volume from /data/freesurfer/subjects/subject_003/mri/orig.mgz
input volume: 256 x 256 x 256, 1mm isotropic
computing tissue intensity peaks...
finding WM peak...WM peak found at intensity 110
finding GM peak...GM peak found at intensity 75
computing intensity normalization parameters...
applying intensity normalization...
pass 1 of 1...
  slice 50 of 256
  slice 100 of 256
  slice 150 of 256
  slice 200 of 256
  slice 250 of 256
normalization complete
writing output to /data/freesurfer/subjects/subject_003/mri/T1.mgz
mri_normalize finished without error at Mon Jan 15 17:15:45 UTC 2024

#--------------------------------------------
#@# Talairach Registration Mon Jan 15 17:15:45 UTC 2024
talairach_avi --i /data/freesurfer/subjects/subject_003/mri/orig.mgz --xfm /data/freesurfer/subjects/subject_003/mri/transforms/talairach.auto.xfm
reading input volume...
volume dimensions: 256 256 256
voxel size: 1.000 1.000 1.000
computing initial alignment...
initial transform computed
optimizing 9-parameter affine registration...
iteration 1: cost = 0.8234
iteration 2: cost = 0.7891
iteration 3: cost = 0.7456
iteration 4: cost = 0.7123
iteration 5: cost = 0.6989
iteration 6: cost = 0.6945
iteration 7: cost = 0.6932
convergence achieved
writing transform to /data/freesurfer/subjects/subject_003/mri/transforms/talairach.auto.xfm
talairach_avi finished without error at Mon Jan 15 17:17:23 UTC 2024

#--------------------------------------------
#@# Talairach Registration (lta) Mon Jan 15 17:17:23 UTC 2024
lta_convert --src /data/freesurfer/subjects/subject_003/mri/orig.mgz --trg $FREESURFER_HOME/average/mni305.cor.mgz --inxfm /data/freesurfer/subjects/subject_003/mri/transforms/talairach.auto.xfm --outlta /data/freesurfer/subjects/subject_003/mri/transforms/talairach.lta
reading source volume...
reading target volume...
reading transform...
converting xfm to lta format...
writing lta to /data/freesurfer/subjects/subject_003/mri/transforms/talairach.lta
lta_convert finished without error at Mon Jan 15 17:17:25 UTC 2024

#--------------------------------------------
#@# Intensity Normalization 2 Mon Jan 15 17:17:25 UTC 2024
mri_normalize -g 1 -mprage -aseg /data/freesurfer/subjects/subject_003/mri/aseg.auto_noCCseg.mgz /data/freesurfer/subjects/subject_003/mri/norm.mgz /data/freesurfer/subjects/subject_003/mri/brain.mgz
reading norm volume...
reading aseg volume...
computing control points...
control points: 18543
fitting intensity correction field...
applying intensity normalization...
  slice 50 of 256
  slice 100 of 256
  slice 150 of 256
  slice 200 of 256
  slice 250 of 256
writing output volume...
mri_normalize finished without error at Mon Jan 15 17:19:34 UTC 2024

#--------------------------------------------
#@# Skull Stripping Mon Jan 15 17:19:34 UTC 2024
#
# Running: mri_watershed -T1 -brain_atlas /usr/local/freesurfer/average/RB_all_withskull_2016-05-10.vc700.gca /data/freesurfer/subjects/subject_003/mri/transforms/talairach_with_skull.lta /data/freesurfer/subjects/subject_003/mri/T1.mgz /data/freesurfer/subjects/subject_003/mri/brainmask.auto.mgz
#
mri_watershed starting...
reading input volume /data/freesurfer/subjects/subject_003/mri/T1.mgz
input volume: 256 x 256 x 256, voxel size 1.00mm
reading brain atlas /usr/local/freesurfer/average/RB_all_withskull_2016-05-10.vc700.gca
reading transform /data/freesurfer/subjects/subject_003/mri/transforms/talairach_with_skull.lta
loading atlas priors...
atlas loaded successfully
allocating working buffers...
buffer allocation: computing required memory...
estimated memory requirement: 4096 MB
attempting to allocate main processing buffer...

ERROR: Unable to allocate memory buffer
malloc failed: Cannot allocate memory
Requested: 4096 MB
Available system memory insufficient for processing
Memory allocation failed in watershed_brain_surface_estimation()

Linux memory status at failure:
MemTotal:        3932160 kB
MemFree:          245632 kB
MemAvailable:     412288 kB
Buffers:           98304 kB
Cached:           256128 kB

Process killed by system: Out of memory
mri_watershed exited with ERROR code 137

#--------------------------------------------
# ERROR SUMMARY
#--------------------------------------------
# recon-all -s subject_003 exited with ERRORS at Mon Jan 15 17:20:18 UTC 2024
# Stage failed: Skull Stripping (mri_watershed)
# Error: Memory allocation failure
# Total processing time: 0 hours 7 minutes 33 seconds
#
# To view the log file:
# less /data/freesurfer/subjects/subject_003/scripts/recon-all.log
#
# To continue after fixing the issue:
# recon-all -s subject_003 -all -no-isrunning